[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Advances in Artificial Intelligence for Data Visualization: Developing Computer Vision Models to Automate Reading of Data Plots, with Application to Regression Diagnostics",
    "section": "",
    "text": "A thesis submitted for the degree of Doctor of Philosophy at Monash University, Department of Econometrics & Business Statistics.\nCopyright notice\nProduced on 25 June 2024.\n© Weihao Li (2024).\nAbstract\nThe abstract should outline the main approach and findings of the thesis and must not be more than 500 words.\nDeclaration\n\nUse only one of the following declarations (Standard thesis or Thesis including published works declaration) and remove the other.\n\nStandard thesis\nThis thesis is an original work of my research and contains no material which has been accepted for the award of any other degree or diploma at any university or equivalent institution and that, to the best of my knowledge and belief, this thesis contains no material previously published or written by another person, except where due reference is made in the text of the thesis.\nStudent name:\nStudent signature:\nDate:\nPublications during enrolment\n\nRemove this section if you do not have publications.\n\nThe material in Chapter 1 has been submitted to the journal Journal of Impossible Results for possible publication.\nThe contribution in ?sec-litreview of this thesis was presented in the International Symposium on Nonsense held in Dublin, Ireland, in July 2022.\nReproducibility statement\nThis thesis is written using Quarto with renv (Ushey 2022) to create a reproducible environment. All materials (including the data sets and source files) required to reproduce this document can be found at the Github repository github.com/SusanSu/thesis.\nThis work is licensed under a Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License.\nThesis including published works declaration\nI hereby declare that this thesis contains no material which has been accepted for the award of any other degree or diploma at any university or equivalent institution and that, to the best of my knowledge and belief, this thesis contains no material previously published or written by another person, except where due reference is made in the text of the thesis.\nThis thesis includes ?? original papers published in peer reviewed journals and ?? submitted publications. The core theme of the thesis is ??. The ideas, development and writing up of all the papers in the thesis were the principal responsibility of myself, the student, working within the Department of Econometrics & Business Statistics under the supervision of ??\n(The inclusion of co-authors reflects the fact that the work came from active collaboration between researchers and acknowledges input into team-based research.)\nIn the case of (??insert chapter numbers) my contribution to the work involved the following:\n\n\n\n\nThesis chapter\nPublication title\nStatus\nNature and % of student contribution\nNature and % of coauthors' contribution\nCoauthors are Monash students\n\n\n2\nThe life cycle of Mongolian crickets\nSubmitted\nConcept and data analysis, writing first draft: 60%\nShu Xu, input into manuscript: 25%; Eddie Betts, input into manuscript: 15%\nShu Xu: No; Eddie Betts: Yes\n\n\n\n\nI have / have not renumbered sections of submitted or published papers in order to generate a consistent presentation within the thesis.\nStudent name:\nStudent signature:\nDate:\nI hereby certify that the above declaration correctly reflects the nature and extent of the student’s and co-authors’ contributions to this work. In instances where I am not the responsible author I have consulted with the responsible author to agree on the respective contributions of the authors.\nMain Supervisor name:\nMain Supervisor signature:\nDate:\nAcknowledgements\nI would like to thank my pet goldfish for …\n\nIn accordance with Chapter 7.1.4 of the research degrees handbook, if you have engaged the services of a professional editor, you must provide their name and a brief description of the service rendered. If the professional editor’s current or former area of academic specialisation is similar your own, this too should be stated as it may suggest to examiners that the editor’s advice to the student has extended beyond guidance on English expression to affect the substance and structure of the thesis.\n\n\nIf you have used generative artificial intelligence (AI) technologies, you must include a written acknowledgment of the use and its extent. Your acknowledgement should at a minimum specify which technology was used, include explicit description on how the information was generated, and explain how the output was used in your work. Below is a suggested format:\n\n\n“I acknowledge the use of [insert AI system(s) and link] to [specific use of generative artificial intelligence]. The output from these was used to [explain use].”\n\n\nFree text section for you to record your acknowledgment and gratitude for the more general academic input and support such as financial support from grants and scholarships and the non-academic support you have received during the course of your enrolment. If you are a recipient of the “Australian Government Research Training Program Scholarship”, you are required to include the following statement:\n\n\n\n“This research was supported by an Australian Government Research Training Program (RTP) Scholarship.”\n\n\n\nYou may also wish to acknowledge significant and substantial contribution made by others to the research, work and writing represented and/or reported in the thesis. These could include significant contributions to: the conception and design of the project; non-routine technical work; analysis and interpretation of research data; drafting significant parts of the work or critically revising it so as to contribute to the interpretation.\n\n\n\n\n\n\nUshey, K. (2022), renv: Project environments."
  },
  {
    "objectID": "01-chap1.html#quarto",
    "href": "01-chap1.html#quarto",
    "title": "1  Introduction",
    "section": "\n1.1 Quarto",
    "text": "1.1 Quarto\nIn this template, the rest of the chapter shows how to use quarto. The big advantage of using quarto is that it allows you to include your R or Python code directly into your thesis, to ensure there are no errors in copying and pasting, and that everything is reproducible. It also helps you stay better organized.\nFor details on using Quarto, see http://quarto.org."
  },
  {
    "objectID": "01-chap1.html#data",
    "href": "01-chap1.html#data",
    "title": "1  Introduction",
    "section": "\n1.2 Data",
    "text": "1.2 Data\nIncluded in this template is a file called sales.csv. This contains quarterly data on Sales and Advertising budget for a small company over the period 1981–2005. It also contains the GDP (gross domestic product) over the same period. All series have been adjusted for inflation. We can load in this data set using the following code:\n\nsales &lt;- readr::read_csv(here::here(\"data/sales.csv\")) |&gt;\n  rename(Quarter = `...1`) |&gt;\n  mutate(\n    Quarter = as.Date(paste0(\"01-\", Quarter), \"%d-%b-%y\"),\n    Quarter = yearquarter(Quarter)\n  ) |&gt;\n  as_tsibble(index = Quarter)\n\nAny data you use in your thesis can go into the data directory. The data should be in exactly the format you obtained it. Do no editing or manipulation of the data prior to including it in the data directory. Any data munging should be scripted and form part of your thesis files (possibly hidden in the output)."
  },
  {
    "objectID": "01-chap1.html#figures",
    "href": "01-chap1.html#figures",
    "title": "1  Introduction",
    "section": "\n1.3 Figures",
    "text": "1.3 Figures\nFigure 1.1 shows time plots of the data we just loaded. Notice how figure captions and references work. Chunk names can be used as figure labels with fig- prefixed. Never manually type figure numbers, as they can change when you add or delete figures. This way, the figure numbering is always correct.\n\n\n\n\nFigure 1.1: Quarterly sales, advertising and GDP data."
  },
  {
    "objectID": "01-chap1.html#results-from-analyses",
    "href": "01-chap1.html#results-from-analyses",
    "title": "1  Introduction",
    "section": "\n1.4 Results from analyses",
    "text": "1.4 Results from analyses\nWe can fit a regression model to the sales data.\nIf y_t denotes the sales in quarter t, x_t denotes the corresponding advertising budget and z_t denotes the GDP, then the resulting model is: \n  y_t = \\beta x_t + \\gamma z_t + \\varepsilon_t\n\\tag{1.1} where \\hat{\\beta} = 1.85, and \\hat{\\gamma} = 1.04. We can reference this equation using Equation 1.1."
  },
  {
    "objectID": "01-chap1.html#tables",
    "href": "01-chap1.html#tables",
    "title": "1  Introduction",
    "section": "\n1.5 Tables",
    "text": "1.5 Tables\nWe can also make a nice summary table of the coefficients, as shown in Table 1.1\n\n\n\n\nTable 1.1: Coefficients from the fitted model.\n\nCoefficient\nEstimate\nP value\n\n\n\n(Intercept)\n-438.98\n0.02\n\n\nGDP\n1.04\n0.02\n\n\nAdBudget\n1.85\n0.00\n\n\n\n\n\n\nAgain, notice the use of labels and references to automatically generate table numbers."
  },
  {
    "objectID": "02-chap2.html",
    "href": "02-chap2.html",
    "title": "2  A Plot is Worth a Thousand Tests: Assessing Residual Diagnostics with the Lineup Protocol",
    "section": "",
    "text": "3 Limitations and Practicality\nOne of the primary limitations of the lineup protocol lies in its reliance on human judgements. In this context, the effectiveness of a single lineup evaluation can be dependent on the perceptual ability and visual skills of the individual. However, when results from multiple individuals are combined the outcome is encouragingly high-quality and robust. For simple plots and strong patterns just a few individuals are needed to arrive at a clear answer, but more individuals will be needed when the plot design is complex, or the signal strength is weak.\nUsing a lineup protocol removes subjectiveness in interpreting patterns in plots. A plot is compared with draws from a null model, in much the same way as a test statistic is compared to its sampling distribution. It is important to remove plot elements that might introduce bias, such as axis labels, text and legends, or to make them generic.\nThe lineup protocol can be used cheaply and informally with the R package nullabor. There is evidence that it is being used fairly broadly, based on software download rates and citations of the original papers. For residual plot analysis we recommend that the lineup be the default first plot so that the data plot is only seen in the context of null plots. When a rigorous test is needed, we recommend using a crowd-sourcing service, as done in gene expression experiment described in Yin et al. (2013). While it takes extra effort it is not difficult today, and costs are tiny compared to the overall costs of conducting a scientific experiment. We do also expect that at some point a computer vision model can be developed to take over the task of employing people to evaluate residual plots.\nFor this study, simulated data was used to provide a precisely controlled environment within which to compare results from conventional testing to those from visual testing. We also explored only the most commonly used, the residual vs fitted value plots. However, we expect the behaviour of the conventional test and the visual test to be similar when observed residuals are diagnosed with this type of plot or other residual plots. The conventional tests will be more sensitive to small departures from the null. They will also fail to detect departures when residuals have some contamination, like outliers or anomalies, as is often encountered when working with data. The lineup approach is well-suited for generally interpreting data plots, and also detecting unexpected patterns not related to the model. This is supported by earlier research (e.g. Loy et al. 2016; Loy and Hofmann 2015; Roy Chowdhury et al. 2015; VanderPlas and Hofmann 2016; Wickham et al. 2010).\nThis paper has described experimental evidence providing support for the advice of regression analysis experts that residual plots are indispensable methods for assessing model fit, using the formal framework of the lineup protocol. We conducted a perceptual experiment on scatterplots of residuals vs fitted values, with two primary departures from good residuals: non-linearity and heteroskedasticity. We found that conventional residual-based statistical tests are more sensitive to weak departures from model assumptions than visual tests. That is, a conventional test concludes there are problems with the model fit almost twice as often as a human. Conventional tests often reject the null hypothesis when departures in the form of non-linearity and heteroskedasticity are not visibly different from null residual plots.\nWhile it might be argued that the conventional tests are correctly detecting small but real effects, this can also be seen as the conventional tests are rejecting unnecessarily. Many of these rejections happen even when downstream analysis and results would not be significantly affected by the small departures from a good fit. The results from human evaluations provide a more practical solution, which reinforces the statements from regression experts that residual plots are an indispensable method for model diagnostics. Further work would be needed to quantify how much departure from good residuals is too much.\nIt is important to emphasize that this work also supports a change in common practice, which is to deliver residual plots as a lineup, embedded in a field of null plots, rather than be viewed out of context. A residual plot may contain many visual features, but some are caused by the characteristics of the predictors and the randomness of the error, not by the violation of the model assumptions. These irrelevant visual features have a chance to be filtered out by participants with a comparison to null plots, resulting in more accurate reading. The lineup enables a careful calibration for reading structure in residual plots, and also provides the potential to discover interesting and important features in the data not directly connected to linear model assumptions.\nHuman evaluation of residuals is expensive, time-consuming and laborious. This is possibly why residual plot analysis is often not done in practice. However, with the emergence of effective computer vision, it is hoped this work helps to lay the foundation for automated residual plot assessment.\nThe experiment also revealed some interesting results. For the most part, the visual test performed similarly to the appropriate conventional test with a shift in the power curve. Unlike conventional tests, where one needs to specifically test for non-linearity or heteroskedasticity the visual test operated effectively across the range of departures from good residuals. If the fitted value distribution is not uniform, there is a small loss of power in the visual test. Surprisingly, there is a big difference in power of the conventional test across fitted value distributions. Another unexpected finding was that the direction of heteroskedasticity appears to affect the ability to visually detect it: both triangles being more difficult to detect than the butterfly, and a small difference in detection between left- and right-triangle."
  },
  {
    "objectID": "02-chap2.html#sec-introduction",
    "href": "02-chap2.html#sec-introduction",
    "title": "2  A Plot is Worth a Thousand Tests: Assessing Residual Diagnostics with the Lineup Protocol",
    "section": "\n2.1 Introduction",
    "text": "2.1 Introduction\n\n“Since all models are wrong the scientist must be alert to what is importantly wrong.” (Box 1976)\n\nDiagnosing a model is an important part of building an appropriate model. In linear regression analysis, studying the residuals from a model fit is a common diagnostic activity. Residuals summarise what is not captured by the model, and thus provide the capacity to identify what might be wrong.\nWe can assess residuals in multiple ways. To examine the univariate distribution, residuals may be plotted as a histogram or normal probability plot. Using the classical normal linear regression model as an example, if the distribution is symmetric and unimodal, we would consider it to be well-behaved. However, if the distribution is skewed, bimodal, multimodal, or contains outliers, there would be cause for concern. We can also inspect the distribution by conducting a goodness-of-fit test, such as the Shapiro-Wilk normality test (Shapiro and Wilk 1965).\nScatterplots of residuals against the fitted values, and each of the explanatory variables, are commonly used to scrutinize their relationships. If there are any visually discoverable associations, the model is potentially inadequate or incorrectly specified. We can also potentially discover patterns not directly connected to a linear model assumption from these residual plots, such as the discreteness or skewness of the fitted values, and outliers. To read residual plots, one looks for noticeable departures from the model such as non-linear pattern or heteroskedasticity. A non-linear pattern would suggest that the model needs to have some additional non-linear terms. Heteroskedasticity suggests that the error is dependent on the predictors, and hence violates the independence assumption. Statistical tests were developed to provide objective assessment, for example, of non-linear patterns (e.g. Ramsey 1969), and heteroskedasticity (e.g. Breusch and Pagan 1979).\nThe common wisdom of experts is that plotting the residuals is indispensable for diagnosing model fits (Cook and Weisberg 1982; Draper and Smith 1998; Montgomery et al. 1982). The lack of empirical evidence for the ubiquitous advice is curious, and is what this article tackles.\nAdditionally, relying solely on the subjective assessment of a single plot can be problematic. People will almost always see a pattern (see Kahneman 2011), so the question that really needs answering is whether any pattern perceived is consistent with randomness, or sampling variability, or noise. Correctly judging whether no pattern exists in a residual plot is a difficult task. Loy (2021) emphasizes that this is especially difficult to teach to new analysts and students, and advocates to the broader use of the lineup protocol (Buja et al. 2009a).\nThe lineup protocol places a data plot in a field of null plots, allowing for a comparison of patterns due purely by chance to what is perceived in the data plot. For residual analysis this is especially helpful for gauging whether there is no pattern. (Figure 2.1 shows an example of a lineup of residual plots.) In its strict use, one would insist that the data plot is not seen before seeing the lineup, so that the observer does not know which is the true plot. When used this way, it provides an objective test for data plots. Majumder et al. (2013a) validated that results from lineups assessed by human observers performed similarly to conventional tests. One would not use a lineup when a conventional test exists and is adequate because it is more manually expensive to conduct. However, where no adequate conventional test exists, it is invaluable, as shown by Loy and Hofmann (2013). Here we use the lineup as a vehicle to rigorously explore why experts advise that residual plots are indispensable despite the prevalence of numerical tests.\nThe paper is structured as follows. Section 2.2 describes the background on the types of departures that one expects to detect, and outlines a formal statistical process for reading residual plots, called visual inference. Section 2.3 describes the calculation of the statistical significance and power of the test. Section 2.4 details the experimental design to compare the decisions made by formal hypothesis testing, and how humans would read diagnostic plots. The results are reported in Section 2.5. We conclude with a discussion of the presented work, and ideas for future directions.\n\n\n\n\nFigure 2.1: Visual testing is conducted using a lineup, as in the example here. The residual plot computed from the observed data is embedded among 19 null plots, where the residuals are simulated from a standard error model. Computing the p-value requires that the lineup be examined by a number of human judges, each asked to select the most different plot. A small p-value would result from a substantial number selecting the data plot (at position 6, exhibiting non-linearity)."
  },
  {
    "objectID": "02-chap2.html#sec-background",
    "href": "02-chap2.html#sec-background",
    "title": "2  A Plot is Worth a Thousand Tests: Assessing Residual Diagnostics with the Lineup Protocol",
    "section": "\n2.2 Background",
    "text": "2.2 Background\n\n2.2.1 Departures from Good Residual Plots\nGraphical summaries where residuals are plotted against fitted values, or other functions of the predictors (expected to be approximately orthogonal to the residuals) are considered to be the most important residual plots by Cook and Weisberg (1999). Figure 2.2A shows an example of an ideal residual plot where points are symmetrically distributed around the horizontal zero line (red), with no discernible patterns. There can be various types of departures from this ideal pattern. Non-linearity, heteroskedasticity and non-normality, shown in Figure 2.2B, Figure 2.2C, and Figure 2.2D, respectively, are three commonly checked departures.\n\n\n\n\nFigure 2.2: Example residual vs fitted value plots (horizontal line indicates 0): (A) classically good looking residuals, (B) non-linear pattern indicates that the model has not captured a non-linear association, (C) heteroskedasticity indicating that variance around the fitted model is not uniform, and (D) non-normality where the residual distribution is not symmetric around 0. The latter pattern might best be assessed using a univariate plot of the residuals, but patterns B and C need to be assessed using a residual vs fitted value plot.\n\n\n\nModel misspecification occurs if functions of predictors that needed to accurately describe the relationship with the response are incorrectly specified. This includes instances where a higher-order polynomial term of a predictor is wrongfully omitted. Any non-linear pattern visible in the residual plot could be indicative of this problem. An example residual plot containing visual pattern of non-linearity is shown in Figure 2.2B. One can clearly observe the “S-shape” from the residual plot, which corresponds to the cubic term that should have been included in the model.\nHeteroskedasticity refers to the presence of non-constant error variance in a regression model. It indicates that the distribution of residuals depends on the predictors, violating the independence assumption. This can be seen in a residual plot as an inconsistent spread of the residuals relative to the fitted values or predictors. An example is the “butterfly” shape shown in Figure 2.2C, or a “left-triangle” and “right-triangle” shape where the smallest variance occurs at one side of the horizontal axis.\nFigure 2.2D shows a scatterplot where the residuals have a skewed distribution, as seen by the uneven vertical spread. Unlike non-linearity and heteroskedasticity, non-normality is usually detected with a different type of residual plot: a histogram or a normal probability plot. Because we focus on scatterplots, non-normality is not one of the departures examined in depth in this paper. (Loy et al. 2016 discuss related work on non-normality checking.)\n\n2.2.2 Conventionally Testing for Departures\nMany different hypothesis tests are available to detect specific model defects. For example, the presence of heteroskedasticity can usually be tested by applying the White test (White 1980) or the Breusch-Pagan (BP) test (Breusch and Pagan 1979), which are both derived from the Lagrange multiplier test (Silvey 1959) principle that relies on the asymptotic properties of the null distribution. To test specific forms of non-linearity, one may apply the F-test as a model structural test to examine the significance of a specific polynomial and non-linear forms of the predictors, or the significance of proxy variables as in the Ramsey Regression Equation Specification Error Test (RESET) (Ramsey 1969). The Shapiro-Wilk (SW) normality test (Shapiro and Wilk 1965) is the most widely used test of non-normality included by many of the statistical software programs. The Jarque-Bera test (Jarque and Bera 1980) is also used to directly check whether the sample skewness and kurtosis match a normal distribution.\nTable 2.1 displays the p-values from the RESET, BP and SW tests applied to the residual plots in Figure 2.2. The RESET test and BP test were computed using the resettest and bptest functions from the R package lmtest, respectively. The SW test was computed using the shapiro.test from the core R package stats. 1 The RESET test requires the selection of a power parameter. Ramsey (1969) recommends a power of four, which we adopted in our analysis.\nFor residual plots in Figure 2.2, we would expect the RESET test for non-linearity to reject residual plot B, the BP test for heteroskedasticity to reject the residual plot C, and the SW test for non-normality to reject residual plot D, which they all do and all tests also correctly fail to reject residual plot A. Interestingly, the BP and SW tests also reject the residual plots exhibiting structure that they were not designed for. Cook and Weisberg (1982) explain that most residual-based tests for a particular departure from the model assumptions are also sensitive to other types of departures. This could be considered a Type III error (Kimball 1957), where the null hypothesis of good residuals is correctly rejected but for the wrong reason. Also, some types of departure can have elements of other types of departure, for example, non-linearity can appear like heteroskedasticity. Additionally, other data problems such as outliers can trigger rejection (or not) of the null hypothesis (Cook and Weisberg 1999).\nWith large sample sizes, hypothesis tests may reject the null hypothesis when there is only a small effect. (A good discussion can be found in Kirk (1996).) While such rejections may be statistically correct, their sensitivity may render the results impractical. A key goal of residual plot diagnostics is to identify potential issues that could lead to incorrect conclusions or errors in subsequent analyses, but minor defects in the model are unlikely to have a significant impact and may be best disregarded for practical purposes. The experiment discussed in this paper specifically addresses this tension between statistical significance and practical significance.\n\n\n\n\nTable 2.1: Statistical significance testing for departures from good residuals for plots in Figure 2.2. Shown are the p-values calculated for the RESET, the BP and the SW tests. The good residual plot (A) is judged a good residual plot, as expected, by all tests. The non-linearity (B) is detected by all tests, as might be expected given the extreme structure.\n\nPlot\nDepartures\nRESET\nBP\nSW\n\n\n\nA\nNone\n0.779\n0.133\n0.728\n\n\nB\nNon-linearity\n0.000\n0.000\n0.039\n\n\nC\nHeteroskedasticity\n0.658\n0.000\n0.000\n\n\nD\nNon-normality\n0.863\n0.736\n0.000\n\n\n\n\n\n\n\n\n\n2.2.3 Visual Test Procedure based on Lineups\nThe examination of data plots to infer signals or patterns (or lack thereof) is fraught with variation in the human ability to interpret and decode the information embedded in a graph (Cleveland and McGill 1984). In practice, over-interpretation of a single plot is common. For instance, Roy Chowdhury et al. (2015) described a published example where authors over-interpreted separation between gene groups from a two-dimensional projection of a linear discriminant analysis even when there were no differences in the expression levels between the gene groups.\nOne solution to over-interpretation is to examine the plot in the context of natural sampling variability assumed by the model, called the lineup protocol, as proposed in Buja et al. (2009b). Majumder et al. (2013b) showed that the lineup protocol is analogous to the null hypothesis significance testing framework. The protocol consists of m randomly placed plots, where one plot is the data plot, and the remaining m - 1 plots, referred to as the null plots, are constructed using the same graphical procedure as the data plot but the data is replaced with null data that is generated in a manner consistent with the null hypothesis, H_0. Then, an observer who has not seen the data plot is asked to point out the most different plot from the lineup. Under H_0, it is expected that the data plot would have no distinguishable difference from the null plots, and the probability that the observer correctly picks the data plot is 1/m. If one rejects H_0 as the observer correctly picks the data plot, then the Type I error of this test is 1/m. This protocol requires a priori specification of H_0 (or at least a null data generating mechanism), much like the requirement of knowing the sampling distribution of the test statistic in null hypothesis significance testing framework.\nFigure Figure 2.1 is an example of a lineup protocol. If the data plot at position 6 is identifiable, then it is evidence for the rejection of H_0. In fact, the actual residual plot is obtained from a misspecified regression model with missing non-linear terms.\nData used in the m - 1 null plots needs to be simulated. In regression diagnostics, sampling data consistent with H_0 is equivalent to sampling data from the assumed model. As Buja et al. (2009b) suggested, H_0 is usually a composite hypothesis controlled by nuisance parameters. Since regression models can have various forms, there is no general solution to this problem, but it sometimes can be reduced to a so called “reference distribution” by applying one of the three methods: (i) sampling from a conditional distribution given a minimal sufficient statistic under H_0, (ii) parametric bootstrap sampling with nuisance parameters estimated under H_0, and (iii) Bayesian posterior predictive sampling. The conditional distribution given a minimal sufficient statistic is the best justified reference distribution among the three (Buja et al. 2009b). Under this method, the null residuals can essentially be simulated by independent drawing from a standard normal random distribution, then regressing the draws on the predictors, and then re-scaling it by the ratio of the residual sum of square in two regressions.\nThe effectiveness of lineup protocol for regression analysis has been validated by Majumder et al. (2013b) under relatively simple settings with up to two predictors. Their results suggest that visual tests are capable of testing the significance of a single predictor with a similar power to a t-test, though they express that in general it is unnecessary to use visual inference if there exists a corresponding conventional test, and they do not expect the visual test to perform equally well as the conventional test. In their third experiment, where the contamination of the data violate the assumptions of the conventional test, visual test outperforms the conventional test by a large margin. This supports the use of visual inference in situations where there are no existing numerical testing procedures. Visual inference has also been integrated into diagnostics for hierarchical linear models where the lineup protocol is used to judge the assumptions of linearity, normality and constant error variance for both the level-1 and level-2 residuals (Loy and Hofmann 2013, 2014, 2015)."
  },
  {
    "objectID": "02-chap2.html#sec-significance-calculation",
    "href": "02-chap2.html#sec-significance-calculation",
    "title": "2  A Plot is Worth a Thousand Tests: Assessing Residual Diagnostics with the Lineup Protocol",
    "section": "\n2.3 Calculation of Statistical Significance and Test Power",
    "text": "2.3 Calculation of Statistical Significance and Test Power\n\n2.3.1 What is Being Tested?\nIn diagnosing a model fit using the residuals, we are generally interested in testing whether “the regression model is correctly specified” (H_0) against the broad alternative “the regression model is misspecified” (H_a). However, it is practically impossible to test this broad H_0 with conventional tests, because they need specific structure causing the departure to be quantifiable in order to be computable. For example, the RESET test for detecting non-linear departures is formulated by fitting y = \\tau_0 + \\sum_{i=1}^{p}\\tau_px_p +\\gamma_1\\hat{y}^2 + \\gamma_2\\hat{y}^3 + \\gamma_3\\hat{y}^4 + u, ~~u \\sim N(0, \\sigma_u^2) in order to test H_0:\\gamma_1 = \\gamma_2 = \\gamma_3 = 0 against H_a: \\gamma_1 \\neq 0 \\text{ or } \\gamma_2 \\neq 0 \\text{ or } \\gamma_3 \\neq 0. Similarly, the BP test is designed to specifically test H_0: error variances are all equal (\\zeta_i=0 \\text{ for } i=1,..,p) versus the alternative H_a: that the error variances are a multiplicative function of one or more variables (\\text{at least one } \\zeta_i\\neq 0) from e^2 = \\zeta_0 + \\sum_{i=1}^{p}\\zeta_i x_i + u, ~ u\\sim N(0,\\sigma_u^2).\nWhile a battery of conventional tests for different types of departures could be applied, this is intrinsic to the lineup protocol. The lineup protocol operates as an omnibus test, able to detect a range of departures from good residuals in a single application.\n\n2.3.2 Statistical Significance\nIn hypothesis testing, a p-value is defined as the probability of observing test results at least as extreme as the observed result assuming H_0 is true. Conventional hypothesis tests usually have an existing method to derive or compute the p-value based on the null distribution. The method to estimate a p-value for a visual test essentially follows the process detailed by VanderPlas et al. (2021). Details are given in Appendix A.1.\n\n2.3.3 Power of the Tests\nThe power of a model misspecification test is the probability that H_0 is rejected given the regression model is misspecified in a specific way. It is an important indicator when one is concerned about whether model assumptions have been violated. In practice, one might be more interested in knowing how much the residuals deviate from the model assumptions, and whether this deviation is of practical significance.\nThe power of a conventional hypothesis test is affected by both the true parameters \\boldsymbol{\\theta} and the sample size n. These two can be quantified in terms of effect size E to measure the strength of the residual departures from the model assumptions. Details about the calculation of effect size are provided in Section 2.4.2 after the introduction of the simulation model used in our experiment. The theoretical power of a test is sometimes not a trivial solution, but it can be estimated if the data generating process is known. We use a predefined model to generate a large set of simulated data under different effect sizes, and record if the conventional test rejects H_0. The probability of the conventional test rejects H_0 is then fitted by a logistic regression formulated as\n\nPr(\\text{reject}~H_0|H_1,E) = \\Lambda\\left(\\log\\left(\\frac{0.05}{0.95}\\right) + \\beta_1 E\\right),\n\\tag{2.1}\nwhere \\Lambda(.) is the standard logistic function given as \\Lambda(z) = \\exp(z)(1+\\exp(z))^{-1}. The effect size E is the only predictor and the intercept is fixed to \\log(0.05/0.95) so that \\hat{Pr}(\\text{reject}~H_0|H_1,E = 0) = 0.05, the desired significance level.\nThe power of a visual test on the other hand, may additionally depend on the ability of the particular participant, as the skill of each individual may affect the number of observers who identify the data plot from the lineup (Majumder et al. 2013b). To address this issue, Majumder et al. (2013b) models the probability of participant j correctly picking the data plot from lineup l using a mixed-effect logistic regression, with participants treated as random effects. Then, the estimated power of a visual test evaluated by a single participant is the predicted value obtained from the mixed effects model. However, this mixed effects model does not work with scenario where participants are asked to select one or more most different plots. In this scenario, having the probability of a participant j correctly picking the data plot from a lineup l is insufficient to determine the power of a visual test because it does not provide information about the number of selections made by the participant for the calculation of the p-value. Therefore, we directly estimate the probability of a lineup being rejected by assuming that individual skill has negligible effect on the variation of the power. This assumption essentially averages out the subject ability and helps to simplify the model structure, thereby obviating a costly large-scale experiment to estimate complex covariance matrices. The same model given in Equation Equation 2.1 is applied to model the power of a visual test.\nTo study various factors contributing to the power of both tests, the same logistic regression model is fit on different subsets of the collated data grouped by levels of factors. These include the distribution of the fitted values, type of the simulation model and the shape of the residual departures."
  },
  {
    "objectID": "02-chap2.html#sec-experimental-design",
    "href": "02-chap2.html#sec-experimental-design",
    "title": "2  A Plot is Worth a Thousand Tests: Assessing Residual Diagnostics with the Lineup Protocol",
    "section": "\n2.4 Experimental Design",
    "text": "2.4 Experimental Design\nOur experiment was conducted over three data collection periods to investigate the difference between conventional hypothesis testing and visual inference in the application of linear regression diagnostics. Two types of departures, non-linearity and heteroskedasticity, were collected during data collection periods I and II. The data collection period III was designed primarily to measure human responses to null lineups so that the visual p-values can be estimated. Additional lineups for both non-linearity and heteroskedasticity, using uniform fitted value distributions, were included for additional data, and to avoid participant frustration of too many difficult tasks.\nDuring the experiment, every participant recruited from the Prolific crowd-sourcing platform (Palan and Schitter 2018) was presented with a block of 20 lineups. A lineup consisted of a randomly placed data plot and 19 null plots, which were all residual plots drawn with raw residuals on the y-axis and fitted values on the x-axis. An additional horizontal red line was added at y = 0 as a visual reference. The data in the data plot was simulated from one of two models described in Section 2.4.1, while the data of the remaining 19 null plots were generated by the residual rotation technique discussed in Section Section 2.2.3.\nIn each lineup evaluation, the participant was asked to select one or more plots that are most different from others, provide a reason for their selections, and evaluate how different they think the selected plots are from others. If there is no noticeable difference between plots in a lineup, participants had the option to select zero plots without the need to provide a reason. During the process of recording the responses, a zero selection was considered to be equivalent to selecting all 20 plots. No participant was shown the same lineup twice. Information about preferred pronouns, age group, education, and previous experience in visual experiments were also collected. A participant’s submission was only included in the analysis if the data plot is identified for at least one attention check.\nOverall, we collected 7974 evaluations on 1152 unique lineups performed by 443 participants. A summary of the factors used in the experiment can be found in Table 2.2. There were four levels of the non-linear structure, and three levels of heteroskedastic structure. The signal strength was controlled by error variance (\\sigma) for the non-linear pattern, and by a ratio (b) parameter for the heteroskedasticity. Additionally, three levels of sample size (n) and four different fitted value distributions were incorporated.\n\n\n\n\nTable 2.2: Levels of the factors used in data collection periods I, II, and III.\n\n\n\n\n\n\n\n\n\n\n\nNon-linearity\n\n\nHeteroskedasticity\n\n\nCommon\n\n\n\n\nPoly Order (j)\n\n\nSD (σ)\n\n\nShape (a)\n\n\nRatio (b)\n\n\nSize (n)\n\n\nDistribution of the fitted values\n\n\n\n\n\n2\n0.25\n-1\n0.25\n50\nUniform\n\n\n3\n1.00\n0\n1.00\n100\nNormal\n\n\n6\n2.00\n1\n4.00\n300\nSkewed\n\n\n18\n4.00\n\n16.00\n\nDiscrete\n\n\n\n\n\n64.00\n\n\n\n\n\n\n\n\n\n2.4.1 Simulating Departures from Good Residuals\nNon-linearity and Heteroskedasticity\nData collection period I was designed to study the ability of participants to detect non-linearity departures from residual plots. The non-linearity departure was constructed by omitting a jth order Hermite polynomial (Hermite 1864; originally by Laplace 1820) term of the predictor from the simple linear regression equation. Four different values of j = 2, 3, 6, 18 were chosen so that distinct shapes of non-linearity were included in the residual plots. These include “U”, “S”, “M” and “triple-U” shape as shown in Figure 2.3. A greater value of j will result in a curve with more turning points. It is expected that the “U” shape will be the easiest to detect, and as the shape gets more complex it will be harder to perceive in a scatterplot, particularly when there is noise. Figure 2.4 shows the “U” shape for different amounts of noise (\\sigma).\nData collection period II was similar to period I but focuses on heteroskedasticity departures. We generated the heteroskedasticity departures by setting the variance-covariance matrix of the error term as a function of the predictor, but fitted the data with the simple linear regression model, intentionally violated the constant variance assumption. Visual patterns of heteroskedasticity are simulated using three different shapes (a = -1, 0, 1) including “left-triangle”, “butterfly” and “right-triangle” shapes as displayed in Figure 2.5. Figure 2.6 shows the butterfly shape as the ratio parameter (b) is changed. More details about the simulation process are provided in Appendix A.2.\n\n\n\n\nFigure 2.3: Polynomial forms generated for the residual plots used to assess detecting non-linearity. The four shapes are generated by varying the order of polynomial given by j in He_j(.).\n\n\n\n\n\n\n\nFigure 2.4: Examining the effect of \\sigma on the signal strength in the non-linearity detection, for n=300, uniform fitted value distribution and the “U” shape. As \\sigma increases the signal strength decreases, to the point that the “U” is almost unrecognisable when \\sigma=4.\n\n\n\n\n\n\n\nFigure 2.5: Heteroskedasticity forms used in the experiment. Three different shapes (a = -1, 0, 1) are used in the experiment to create “left-triangle”, “butterfly” and “right-triangle” shapes, respectively.\n\n\n\n\n\n\n\nFigure 2.6: Five different values of b are used in heteroskedasticity simulation to control the strength of the signal. Larger values of b yield a bigger difference in variation, and thus stronger heteroskedasticity signal.\n\n\n\nFactors Common to both Data Collection Periods\nFitted values are a function of the independent variables (or predictors), and the distribution of the observed values affects the distribution of the fitted values. Ideally, we would want the fitted values to have a uniform coverage across the range of observed values or have a uniform distribution across all of the predictors. This is not always present in the collected data. Sometimes the fitted values are discrete because one or more predictors were measured discretely. It is also common to see a skewed distribution of fitted values if one or more of the predictors has a skewed distribution. This latter problem is usually corrected before modelling, using a variable transformation. Our simulation assess this by using four different distributions to represent fitted values, constructed by different sampling of the predictor, including U(-1, 1) (uniform), N(0, 0.3^2) (normal), \\text{lognormal}(0, 0.6^2)/3 (skewed) and U\\{-1, 1\\} (discrete).\nFigure 2.7 shows the non-linear pattern, a “U” shape, with the different fitted value distributions. We would expect that structure in residual plots would be easier to perceive when the fitted values are uniformly distributed.\nThree different sample sizes were used in our experiment: n = 50, 100, 300. Figure 2.8 shows the non-linear “S” shape for different sample sizes. We expect signal strength to decline in the simulated data plots with smaller n. We chose 300 as the upper limit, because it is typically enough for structure to be visible in a scatterplot reliably. Beyond 300, the scatterplot should probably be used with transparency or replaced with a density or binned plot as scatterplots suffer from over-plotting.\n\n\n\n\nFigure 2.7: Variations in fitted values, that might affect perception of residual plots. Four different distributions are used.\n\n\n\n\n\n\n\nFigure 2.8: Examining the effect of signal strength for the three different values of n used in the experiment, for non-linear structure with fixed \\sigma = 1.5, uniform fitted value distribution, and “S” shape. For these factor levels, only when n = 300 is the “S” shape clearly visible.\n\n\n\n\n2.4.2 Effect Size\nThe lineups are allocated to participants in a manner that uniformly covers the combination of experimental factors in Table 2.2. In addition, we use effect size to measure the signal strength, which helps in assigning a set of lineups with a range of difficulties to each participant.\nEffect size in statistics measures the strength of the signal relative to the noise. It is surprisingly difficult to quantify, even for simulated data as used in this experiment.\nFor the non-linearity model, the key items defining effect size are sample size (n) and the noise level (\\sigma^2), and so effect size would be roughly calculated as \\sqrt{n}/{\\sigma}. Increasing sample size tends to boost the effect size, while heightened noise diminishes it. However, it is not clear how the additional parameter for the model polynomial order, j, should be incorporated. Intuitively, the large j means more complex pattern, which likely means effect size would decrease. Similarly, in the heteroskedasticity model, effect size relies on sample size (n) and the ratio of the largest to smallest variance, b. Larger values of both would produce higher effect size, but the role of the additional shape parameter, a, in this context is unclear.\nFor the purposes of our calculations we have chosen to use an approach based on Kullback-Leibler divergence (Kullback and Leibler 1951). This formulation defines effect size to be\nE = \\frac{1}{2}\\left(\\log\\frac{|\\text{diag}(\\boldsymbol{R}\\boldsymbol{V}\\boldsymbol{R}')|}{|\\text{diag}(\\boldsymbol{R}\\sigma^2)|} - n + \\text{tr}(\\text{diag}(\\boldsymbol{R}\\boldsymbol{V}\\boldsymbol{R}')^{-1}\\text{diag}(\\boldsymbol{R}\\sigma^2)) + \\boldsymbol{\\mu}_z'(\\boldsymbol{R}\\boldsymbol{V}\\boldsymbol{R}')^{-1}\\boldsymbol{\\mu}_z\\right),\nwhere \\text{diag}(.) is the diagonal matrix constructed from the diagonal elements of a matrix, \\boldsymbol{X} is the design matrix, \\boldsymbol{V} is the actual covariance matrix of the error term, \\boldsymbol{R} = \\boldsymbol{I}_n - \\boldsymbol{X}(\\boldsymbol{X}'\\boldsymbol{X})^{-1}\\boldsymbol{X}' is the residual operator, \\boldsymbol{\\mu}_z = \\boldsymbol{R}\\boldsymbol{Z}\\boldsymbol{\\beta}_z is the expected values of residuals where \\boldsymbol{Z} contains any higher order terms of \\boldsymbol{X} left out of the regression equation, \\boldsymbol{\\beta}_z contains the corresponding coefficients, and \\sigma^2\\boldsymbol{I}_n is the assumed covariance matrix of the error term when H_0 is true. More details about the effect size derivation are provided in Appendix A.1."
  },
  {
    "objectID": "02-chap2.html#sec-results",
    "href": "02-chap2.html#sec-results",
    "title": "2  A Plot is Worth a Thousand Tests: Assessing Residual Diagnostics with the Lineup Protocol",
    "section": "\n2.5 Results",
    "text": "2.5 Results\nData collection used a total of 1152 lineups, and resulted in a total of 7974 evaluations from 443 participants. Roughly half corresponded to the two models, non-linearity and heteroskedasticiy, and the three collection periods had similar numbers of evaluations. Each participant received two of the 24 attention check lineups which were used to filter results of participants who were clearly not making an honest effort (only 11 of 454). To estimate \\alpha for calculating statistical significance (see Appendix A.1) there were 720 evaluations of 36 null lineups. Neither the attention checks nor null lineups were used in the subsequent analysis. The de-identified data, vi_survey, is made available in the R package, visage.\nThe data was collected on lineups constructed from four different fitted value distributions that stem from the corresponding predictor distribution: uniform, normal, skewed and discrete. Henceforth, we refer to these four different fitted value distributions with respect to their predictor distribution. More data was collected on the uniform distribution (each evaluated by 11 participants) than the others (each evaluated by 5 participants). The analysis in Section 2.5.1–Section 2.5.4 uses only results from lineups with uniform distribution, for a total 3069 lineup evaluations. This allows us to compare the conventional and visual test performance in an optimal scenario. Section 2.5.5 examines how the results may be affected if the fitted value distribution was different.\n\n2.5.1 Power Comparison of the Tests\nFigure 2.9 present the power curves of various tests plotted against the effect size in the residuals for non-linearity and heteroskedasticity. In each case the power of visual test is calculated for multiple bootstrap samples leading to the many (solid orange) curves. The effect size was computed at a 5% significance level and plotted on a natural logarithmic scale. To facilitate visual calibration of effect size values with the corresponding diagnostic plots, a sequence of example residual plots with increasing effect sizes is provided at the bottom of these figures. These plots serve as a visual aid to help readers understand how different effect size values translate to changes in the diagnostic plots. The horizontal lines of dots at 0 and 1 represent the non-rejection or rejection decisions made by visual tests for each lineup.\n\n\n\n\nFigure 2.9: Comparison of power between different tests for (A) non-linear and (B) heteroskedasticity patterns (uniform fitted values only). Main plot shows the power curves, with dots indicating non-reject and reject in visual testing of lineups. The multiple lines for the visual test arise from estimating the power on many bootstrap samples. The row of scatterplots at the bottom are examples of residual plots corresponding to the specific effect sizes marked by vertical lines in the main plot.\n\n\n\nFigure 2.9A compares the power for the different tests for non-linear structure in the residuals. The test with the uniformly higher power is the RESET test, one that specifically tests for non-linearity. Note that the BP and SW tests have much lower power, which is expected because they are not designed to detect non-linearity. The bootstrapped power curves for the visual test are effectively a right shift from that of the RESET test. This means that the RESET test will reject at a lower effect size (less structure) than the visual test, but otherwise the performance will be similar. In other words, the RESET test is more sensitive than the visual test. This is not necessarily a good feature for the purposes of diagnosing model defects: if we scan the residual plot examples at the bottom, we might argue that the non-linearity is not sufficiently problematic until an effect size of around 3 or 3.5. The RESET test would reject closer to an effect size of 2, but the visual test would reject closer to 3.25, for a significance level of 0.05. The visual test matches the robustness of the model to (minor) violations of assumptions much better.\nFor the heteroskedasticity pattern, the power of BP test, designed for detecting heteroskedasticity, is uniformly higher than the other tests. The visual test power curve shifts to the right. This shows a similar story to the power curves for non-linearity pattern: the conventional test is more sensitive than the visual test. From the example residual plots at the bottom we might argue that the heteroskedasticity becomes noticeably visible around an effect size of 3 or 3.5. However the BP test would reject at around effect size 2.5. Interestingly, the power curve for the SW test (for non-normality) is only slightly different to that of the visual test, suggesting that it performs reasonably well for detecting heteroskedasticity, too. The power curve for the BP test suggests it is not useful for detecting heteroskedasticity, as expected.\nOverall, the results show that the conventional tests are more sensitive than the visual test. The conventional tests do have higher power for the patterns they are designed to detect, but they typically fail to detect other patterns unless those patterns are particularly strong. The visual test does not require specifying the pattern ahead of time, relying purely on whether the observed residual plot is detectably different from “good” residual plots. They will perform equally well regardless of the type of model defect. This aligns with the advice of experts on residual analysis, who consider residual plot analysis to be an indispensable tool for diagnosing model problems. What we gain from using a visual test for this purpose is the removal of any subjective arguments about whether a pattern is visible or not. The lineup protocol provides the calibration for detecting patterns: if the pattern in the data plot cannot be distinguished from the patterns in good residual plots, then no discernible problem with the model exists.\n\n2.5.2 Comparison of Test Decisions Based on p-values\nThe power comparison demonstrates that the appropriate conventional tests will reject more aggressively than visual tests, but we do not know how the decisions for each lineup would agree or disagree. Here we compare the reject or fail to reject decisions of these tests, across all the lineups. Figure 2.10 shows the agreement of the conventional and visual tests using a mosaic plot for both non-linearity patterns and heteroskedasticity patterns. For both patterns the lineups resulting in a rejection by the visual test are all also rejected by the conventional test, except for one from the heteroskedasticity model. This reflects exactly the story from the previous section, that the conventional tests reject more aggressively than the visual test.\nFor non-linearity lineups, conventional tests and visual tests reject 69% and 32% of the time, respectively. Of the lineups rejected by the conventional test, 46% are rejected by the visual test, that is, approximately half as many as the conventional test. There are no lineups that are rejected by the visual test but not by the conventional test.\nIn heteroskedasticity lineups, 76% are rejected by conventional tests, while 56% are rejected by visual tests. Of the lineups rejected by the conventional test, the visual test rejects more than two-thirds of them, too.\nSurprisingly, the visual test rejects 1 of the 33 (3%) of lineups where the conventional test does not reject. Figure 2.11 shows this lineup. The data plot in position seventeen displays a relatively strong heteroskedasticity pattern, and has a strong effect size (\\log_e(E)=4.02), which is reflected by the visual test p\\text{-value} = 0.026. But the BP test p\\text{-value} = 0.056, is slightly above the significance cutoff of 0.05. This lineup was evaluated by 11 participants, it has experimental factors a = 0 (“butterfly” shape), b = 64 (large variance ratio), n = 50 (small sample size), and a uniform distribution for the predictor. It may have been the small sample size and the presence of a few outliers that may have resulted in the lack of detection by the conventional test.\n\n\n\n\nFigure 2.10: Rejection rate (p-value \\leq0.05) of visual test conditional on the conventional test decision on non-linearity (left) and heteroskedasticity (right) lineups (uniform fitted values only) displayed using a mosaic plot. The visual test rejects less frequently than the conventional test, and (almost) only rejects when the conventional test does. Surprisingly, one lineup in the heteroskedasticity group is rejected by the visual test but NOT the conventional test.\n\n\n\n\n\n\n\nFigure 2.11: The single heteroskedasticity lineup that is rejected by the visual test but not by the BP test. The data plot (position 17) contains a “butterfly” shape. It visibly displays heteroskedasticity, making it somewhat surprising that it is not detected by the BP test.\n\n\n\nBecause the power curve of the visual tests are a shift to the right of the conventional test (Figure 2.9) we examined whether adjusting the significance level (to .001, .0001, .00001, …) of the conventional test would generate similar decisions to that of the visual test. Interestingly, it does not: despite resulting in less rejections, neither the RESET or BP tests come to complete agreement with the visual test (see Appendix A.1).\n\n2.5.3 Effect of Amount of Non-linearity\nThe order of the polynomial is a primary factor contributing to the pattern produced by the non-linearity model. Figure 2.12 explores the relationship between polynomial order and power of the tests. The conventional tests have higher power for lower orders of Hermite polynomials, and the power drops substantially for the “triple-U” shape. To understand why this is, we return to the application of the RESET test, which requires a parameter indicating degree of fitted values to test for, and the recommendation is to generically use four (Ramsey 1969). However, the “triple-U” shape is constructed from the Hermite polynomials using power up to 18. If the RESET test had been applied using a higher power of no less than six, the power curve of “triple-U” shape will be closer to other power curves. This illustrates the sensitivity of the conventional test to the parameter choice, and highlights a limitation: it helps to know the data generating process to set the parameters for the test, which is unrealistic in practice. However, we examined this in more detail (see Appendix A.1) and found that there is no harm in setting the parameter higher than four on the tests’ operation for lower order polynomial shapes. Using a parameter value of six, instead of four, yields higher power regardless of generating process, and is recommended.\nFor visual tests, we expect the “U” shape to be detected more readily, followed by the “S”, “M” and “triple-U” shape. From Figure 2.12, it can be observed that the power curves mostly align with these expectations, except for the “M” shape, which is as easily detected as the “S” shape. This suggests a benefit of the visual test: knowing the shape ahead of time is not needed for its application.\n\n\n\n\nFigure 2.12: The effect of the order of the polynomial on the power of conventional and visual tests. Deeper colour indicates higher order. The default RESET tests under-performs significantly in detecting the “triple-U” shape. To achieve a similar power as other shapes, a higher order polynomial parameter needs to be used for the RESET test, but this higher than the recommended value.\n\n\n\n\n2.5.4 Effect of Shape of Heteroskedasticity\nFigure 2.13 examines the impact of the shape of the heteroskedasticity on the power of of both tests. The butterfly shape has higher power on both types of tests. The “left-triangle” and the “right-triangle” shapes are functionally identical, and this is observed for the conventional test, where the power curves are identical. Interestingly there is a difference for the visual test: the power curve of the “left-triangle” shape is slightly higher than that of the “right-triangle” shape. This indicates a bias in perceiving heteroskedasticity depending on the direction, and may be worth investigating further.\n\n\n\n\nFigure 2.13: The effect of heteroskedasticity shape (parameter a) on the power of conventional and visual tests. The butterfly has higher power in both tests. Curiously, the visual test has a slightly higher power for the left-triangle\" than theright-triangle” shape, when it would be expected that they should be similar, which is observed in conventional testing.\n\n\n\n\n2.5.5 Effect of Fitted Value Distributions\nIn regression analysis, predictions are conditional on the observed values of the predictors, that is, the conditional mean of the dependent variable Y given the value of the independent variable X, \\text{E}(Y|X). This is an often forgotten element of regression analysis but it is important. Where X is observed, the distribution of the X values in the sample, or consequently \\hat{Y}, may affect the ability to read any patterns in the residual plots. The effect of fitted value distribution on test performance is assess using four different distributions of fitted values stemming from the predictor distributions: uniform, normal, discrete and lognormal (skewed). We expect that if all predictors have a uniform distribution, it is easier to read the relationship with the residuals.\n\n\n\n\nFigure 2.14: Comparison of power on lineups with different fitted value distributions for conventional and visual tests (columns) for non-linearity and heteroskedasticity patterns (rows). The power curves of conventional tests for non-linearity and heteroskedasticity patterns are produced by RESET tests and BP tests, respectively. Power curves of visual tests are estimated using five evaluations on each lineup. For lineups with a uniform fitted value distribution, the five evaluations are repeatedly sampled from the total eleven evaluations to give multiple power curves (solid grey). Surprisingly, the fitted value distribution has produces more variability in the power of conventional tests than visual tests. Uneven distributions, normal and skewed distributions, tend to yield lower power.\n\n\n\nFigure 2.14 examines the impact of the fitted value distribution on the power of conventional (left) and visual (right) tests for both the non-linearity (top) and heteroskedasticity (bottom) patterns. For conventional tests, only the power curves of appropriate tests are shown: RESET tests for non-linearity and BP tests for heteroskedasticity. For visual tests, more evaluations on lineups with uniform fitted value distribution were collected, so to have a fair comparison, we randomly sample five from the 11 total evaluations to estimate the power curves, producing the multiple curves for the uniform condition, and providing an indication of the variability in the power estimates.\nPerhaps surprisingly, the visual tests have more consistent power across the different fitted value distributions: for the non-linear pattern, there is almost no power difference, and for the heteroskedastic pattern, uniform and discrete have higher power than normal and skewed. The likely reason is that these latter two have fewer observations in the tails where the heteroskedastic pattern needs to be detected.\nThe variation in power in the conventional tests is at first sight, shocking. However, it is discussed, albeit rarely, in the testing literature. See, for example, Jamshidian et al. (2007), Olvera Astivia et al. (2019) and Zhang and Yuan (2018) which show derivations and use simulation to assess the effect of the observed distribution of the predictors on test power. The big differences in the power curves seen in Figure 2.14 is echoed in the results reported in these articles."
  },
  {
    "objectID": "02-chap2.html#footnotes",
    "href": "02-chap2.html#footnotes",
    "title": "2  A Plot is Worth a Thousand Tests: Assessing Residual Diagnostics with the Lineup Protocol",
    "section": "",
    "text": "Although we did not use it, it is useful to know that the R package skedastic (Farrar 2020) also contains a large collection of functions to test for heteroskedasticity.↩︎"
  },
  {
    "objectID": "refs.html",
    "href": "refs.html",
    "title": "Bibliography",
    "section": "",
    "text": "Box, G. E. (1976), “Science and statistics,” Journal of\nthe American Statistical Association, Taylor & Francis, 71,\n791–799.\n\n\nBreusch, T. S., and Pagan, A. R. (1979), “A simple test for\nheteroscedasticity and random coefficient variation,”\nEconometrica: Journal of the Econometric Society, JSTOR,\n1287–1294.\n\n\nBuja, A., Cook, D., Hofmann, H., Lawrence, M., Lee, E.-K., Swayne, D.\nF., and Wickham, H. (2009a), “Statistical inference for\nexploratory data analysis and model diagnostics,”\nPhilosophical Transactions of the Royal Society A: Mathematical,\nPhysical and Engineering Sciences, The Royal Society Publishing,\n367, 4361–4383.\n\n\nBuja, A., Cook, D., Hofmann, H., Lawrence, M., Lee, E.-K., Swayne, D.\nF., and Wickham, H. (2009b), “Statistical inference for\nexploratory data analysis and model diagnostics,”\nPhilosophical Transactions of the Royal Society A: Mathematical,\nPhysical and Engineering Sciences, 367, 4361–4383. https://doi.org/10.1098/rsta.2009.0120.\n\n\nCleveland, W. S., and McGill, R. (1984), “Graphical perception:\nTheory, experimentation, and application to the development of graphical\nmethods,” Journal of the American Statistical\nAssociation, Taylor & Francis, 79, 531–554.\n\n\nCook, R. D., and Weisberg, S. (1982), Residuals and influence in\nregression, New York: Chapman; Hall.\n\n\nCook, R. D., and Weisberg, S. (1999), Applied regression including\ncomputing and graphics, John Wiley & Sons.\n\n\nDe Leeuw, J. R. (2015), “jsPsych: A JavaScript library for\ncreating behavioral experiments in a web browser,” Behavior\nResearch Methods, Springer, 47, 1–12.\n\n\nDraper, N. R., and Smith, H. (1998), Applied regression\nanalysis, John Wiley & Sons.\n\n\nFarrar, T. J. (2020), Skedastic: Heteroskedasticity diagnostics for\nlinear regression models, Bellville, South Africa: University of\nthe Western Cape.\n\n\nGrinberg, M. (2018), Flask web development: Developing web\napplications with python, \" O’Reilly Media, Inc.\".\n\n\nHermite, M. (1864), Sur un nouveau développement en\nsérie des fonctions, Imprimerie de Gauthier-Villars.\n\n\nHofmann, H., Wickham, H., and Kafadar, K. (2017), “Value plots:\nBoxplots for large data,” Journal of Computational and\nGraphical Statistics, Taylor & Francis, 26, 469–477.\n\n\nJamshidian, M., Jennrich, R. I., and Liu, W. (2007), “A study of\npartial f tests for multiple linear regression models,”\nComputational Statistics & Data Analysis, Elsevier, 51,\n6269–6284.\n\n\nJarque, C. M., and Bera, A. K. (1980), “Efficient tests for\nnormality, homoscedasticity and serial independence of regression\nresiduals,” Economics Letters, Elsevier, 6, 255–259.\n\n\nKahle, D. (2013), “Mpoly: Multivariate polynomials in\nR,” The R Journal, 5, 162–170.\n\n\nKahneman, D. (2011), Thinking, fast and slow, Farrar, Straus;\nGiroux.\n\n\nKimball, A. (1957), “Errors of the third kind in statistical\nconsulting,” Journal of the American Statistical\nAssociation, Taylor & Francis, 52, 133–142.\n\n\nKirk, R. E. (1996), “Practical significance: A concept whose time\nhas come,” Educational and psychological measurement,\nSage Publications Sage CA: Thousand Oaks, CA, 56, 746–759.\n\n\nKullback, S., and Leibler, R. A. (1951), “On information and\nsufficiency,” The Annals of Mathematical Statistics,\nJSTOR, 22, 79–86.\n\n\nLaplace, P.-S. (1820), Théorie analytique des\nprobabilités, Courcier.\n\n\nLoy, A. (2021), “Bringing visual inference to the\nclassroom,” Journal of Statistics and Data Science\nEducation, Taylor & Francis, 29, 171–182.\n\n\nLoy, A., Follett, L., and Hofmann, H. (2016), “Variations of q–q\nplots: The power of our eyes!” The American\nStatistician, Taylor & Francis, 70, 202–214.\n\n\nLoy, A., and Hofmann, H. (2013), “Diagnostic tools for\nhierarchical linear models,” Wiley Interdisciplinary Reviews:\nComputational Statistics, Wiley Online Library, 5, 48–61.\n\n\nLoy, A., and Hofmann, H. (2014), “HLMdiag: A suite of diagnostics\nfor hierarchical linear models in r,” Journal of Statistical\nSoftware, 56, 1–28.\n\n\nLoy, A., and Hofmann, H. (2015), “Are you normal? The problem of\nconfounded residual structures in hierarchical linear models,”\nJournal of Computational and Graphical Statistics, Taylor &\nFrancis, 24, 1191–1209.\n\n\nMajumder, M., Hofmann, H., and Cook, D. (2013a), “Validation of\nvisual statistical inference, applied to linear models,”\nJournal of the American Statistical Association, Taylor &\nFrancis, 108, 942–956.\n\n\nMajumder, M., Hofmann, H., and Cook, D. (2013b), “Validation of\nvisual statistical inference, applied to linear models,”\nJournal of the American Statistical Association, 108, 942–956.\nhttps://doi.org/10.1080/01621459.2013.808157.\n\n\nMontgomery, D. C., Peck, E. A., and Vining, G. G. (1982),\nIntroduction to linear regression analysis, John Wiley &\nSons.\n\n\nOlvera Astivia, O. L., Gadermann, A., and Guhn, M. (2019), “The\nrelationship between statistical power and predictor distribution in\nmultilevel logistic regression: A simulation-based approach,”\nBMC Medical Research Methodology, BioMed Central, 19, 1–20.\n\n\nPalan, S., and Schitter, C. (2018), “Prolific. Ac—a subject pool\nfor online experiments,” Journal of Behavioral and\nExperimental Finance, Elsevier, 17, 22–27.\n\n\nPythonAnywhere LLP (2023), “PythonAnywhere.”\n\n\nRamsey, J. B. (1969), “Tests for specification errors in classical\nlinear least-squares regression analysis,” Journal of the\nRoyal Statistical Society: Series B (Methodological), Wiley Online\nLibrary, 31, 350–371.\n\n\nRoy Chowdhury, N., Cook, D., Hofmann, H., Majumder, M., Lee, E.-K., and\nToth, A. L. (2015), “Using visual statistical inference to better\nunderstand random class separations in high dimension, low sample size\ndata,” Computational Statistics, Springer, 30, 293–316.\nhttps://doi.org/10.1007/s00180-014-0534-x.\n\n\nShapiro, S. S., and Wilk, M. B. (1965), “An analysis of variance\ntest for normality (complete samples),” Biometrika,\nJSTOR, 52, 591–611.\n\n\nSilvey, S. D. (1959), “The lagrangian multiplier test,”\nThe Annals of Mathematical Statistics, JSTOR, 30, 389–407.\n\n\nUshey, K. (2022), renv: Project environments.\n\n\nVanderPlas, S., and Hofmann, H. (2016), “Spatial reasoning and\ndata displays,” IEEE Transactions on Visualization and\nComputer Graphics, 22, 459–468. https://doi.org/10.1109/TVCG.2015.2469125.\n\n\nVanderPlas, S., Röttger, C., Cook, D., and Hofmann, H. (2021),\n“Statistical significance calculations for scenarios in visual\ninference,” Stat, Wiley Online Library, 10, e337.\n\n\nWhite, H. (1980), “A heteroskedasticity-consistent covariance\nmatrix estimator and a direct test for heteroskedasticity,”\nEconometrica: Journal of the Econometric Society, JSTOR,\n817–838.\n\n\nWickham, H., Cook, D., Hofmann, H., and Buja, A. (2010),\n“Graphical inference for infovis,” IEEE Transactions on\nVisualization and Computer Graphics, 16, 973–979. https://doi.org/10.1109/TVCG.2010.161.\n\n\nYin, T., Majumder, M., Roy Chowdhury, N., Cook, D., Shoemaker, R., and\nGraham, M. (2013), “Visual mining methods for RNA-seq data: Data\nstructure, dispersion estimation and significance testing,”\nJournal of Data Mining in Genomics and Proteomics, 4. https://doi.org/10.4172/2153-0602.1000139.\n\n\nZhang, Z., and Yuan, K.-H. (2018), Practical statistical power\nanalysis using webpower and r, Isdsa Press."
  },
  {
    "objectID": "A-appA.html#sec-appendix-a-1",
    "href": "A-appA.html#sec-appendix-a-1",
    "title": "Appendix A — Appendix to “A Plot is Worth a Thousand Tests: Assessing Residual Diagnostics with the Lineup Protocol”",
    "section": "\nA.1 Additional Details of Testing Procedures",
    "text": "A.1 Additional Details of Testing Procedures\n\nA.1.1 Statistical Significance\nWithin the context of visual inference, with K independent observers, the visual p-value can be seen as the probability of having as many or more participants detect the data plot than the observed result.\nThe approach used in Majumder et al. (2013) is as follows. Define X_j = \\{0,1\\} to be a Bernoulli random variable measuring whether participant j detected the data plot, and X = \\sum_{j=1}^{K}X_j be the total number of observers who detected the data plot. Then, by imposing a relatively strong assumption that all K evaluations are fully independent, under H_0 X \\sim \\mathrm{Binom}_{K,1/m}. Therefore, the p-value of a lineup of size m evaluated by K observer is estimated with P(X \\geq x) = 1 - F(x) + f(x), where F(.) is the binomial cumulative distribution function, f(.) is the binomial probability mass function and x is the realization of number of observers choosing the data plot.\nAs pointed out by VanderPlas et al. (2021), this basic binomial model is deficient. It does not take into account the possible dependencies in the visual test due to repeated evaluations of the same lineup, or account for when participants are offered the option to select one or more “most different” plots, or none, from a lineup. They suggest three common lineup scenarios: (1) K different lineups are shown to K participants, (2) K lineups with different null plots but the same data plot are shown to K participants, and (3) the same lineup is shown to K participants. Scenario 3 is the most feasible to apply, but has the most dependencies to accommodate for the p-value calculation. For Scenario 3, VanderPlas et al propose modelling the probability of plot i being selected from a lineup as \\theta_i, where \\theta_i \\sim \\text{Dirichlet}(\\alpha) for i=1,...,m and \\alpha &gt; 0. The number of times plot i being selected in K evaluations is denoted as c_i. In case participant j makes multiple selections, 1/s_j will be added to c_i instead of one, where s_j is the number of plots participant j selected for j=1,...K. This ensures \\sum_{i}c_i=K. Since we are only interested in the selections of the data plot i, the marginal model can be simplified to a beta-binomial model and thus the visual p-value is given as\n\nP(C \\geq c_i) = \\sum_{x=c_i}^{K}{K \\choose x}\\frac{B(x + \\alpha, K - x + (m - 1)\\alpha)}{B(\\alpha, (m-1)\\alpha)},\\quad \\text{for} \\quad c_i \\in \\mathbb{Z}_0^+\n\\tag{A.1}\nwhere B(.) is the beta function defined as\n\nB(a, b) = \\int_{0}^{1}t^{\\alpha - 1}(1-t)^{b-1}dt,\\quad \\text{where}\\quad a,b&gt;0.\n\\tag{A.2}\nWe extend the equation to non-negative real number c_i by applying a linear approximation\n\nP(C \\geq c_i) = P(C \\geq \\lceil c_i \\rceil) + (\\lceil c_i \\rceil - c_i) P(C = \\lfloor c_i \\rfloor), \\quad \\text{for}\\quad c_i \\in \\mathbb{R}_0^+,\n\\tag{A.3}\nwhere P(C \\geq \\lceil c_i \\rceil) is calculated using Equation A.1 and P(C = \\lfloor c_i \\rfloor) is calculated by\n\nP(C = c_i) = {K \\choose c_i}\\frac{B(c_i + \\alpha, K - c_i + (m - 1)\\alpha)}{B(\\alpha, (m-1)\\alpha)},\\quad \\text{for} \\quad c_i \\in \\mathbb{Z}_0^+.\n\\tag{A.4}\nThe parameter \\alpha used in Equation A.1 and Equation A.4 is usually unknown and will need to be estimated from the survey data. An interpretation of \\alpha is that when it is low only a few plots are attractive to the observers and tend to be selected, and when high, most plots are equally likely to be chosen. VanderPlas et al define c-interesting plot to be if c or more participants select the plot as the most different. The expected number of plots selected at least c times, \\mathrm{E}[Z_c], is then calculated as\n\n\\mathrm{E}[Z_c(\\alpha)] = \\frac{m}{B(\\alpha, (m-1)\\alpha)}\\sum_{\\lceil c \\rceil}^{K}{K \\choose x} B(x + \\alpha, K - x + (m-1)\\alpha).\n\\tag{A.5}\nWith Equation A.5, \\alpha can be estimated using maximum likelihood estimation. Precise estimation of \\alpha, is aided by evaluation of Rorschach lineups, where all plots are null plots. In a Rorschach, in theory all plots should be equally likely, but in practice some (irrelevant) visual elements may be more eye-catching than others. This is what \\alpha captures, the capacity for extraneous features to distract the observer for a particular type of plot display.\n\nA.1.2 Effect Size Derivation\nEffect size can be defined as the difference of a parameter for a particular model or distribution, or a statistic derived from a sample. Importantly, it needs to reflect the treatment we try to measure. Centred on a conventional statistical test, we usually can deduce the effect size from the test statistic by substituting the null parameter value. When considering the diagnostics of residual departures, there exist many possibilities of test statistics for a variety of model assumptions. Meanwhile, diagnostic plots such as the residual plot have no general agreement on measuring how strong a model violation pattern is. To build a bridge between various residual-based tests, and the visual test, we focus on the shared information embedded in the testing procedures, which is the distribution of residuals. When comes to comparison of distribution, Kullback-Leibler divergence (Kullback and Leibler 1951) is a classical way to represent the information loss or entropy increase caused by the approximation to the true distribution, which in our case, the inefficiency due to the use of false model assumptions.\nFollowing the terminology introduced by Kullback and Leibler (1951), P represents the measured probability distribution, and Q represents the assumed probability distribution. The Kullback-Leibler divergence is defined as \\int_{-\\infty}^{\\infty}\\log(p(x)/q(x))p(x)dx, where p(.) and q(.) denote probability densities of P and Q.\nLet \\boldsymbol{X} denotes the p + 1 predictors with n observations, \\boldsymbol{b} = (\\boldsymbol{X}'\\boldsymbol{X})^{-1}\\boldsymbol{X}'\\boldsymbol{y} denotes the OLS solution, \\boldsymbol{R} = \\boldsymbol{I}_n -\\boldsymbol{X}(\\boldsymbol{X}'\\boldsymbol{X})^{-1}\\boldsymbol{X}' denotes the residual operator, and let \\boldsymbol{\\varepsilon} \\sim N(\\boldsymbol{0},\\sigma^2\\boldsymbol{I}) denotes the error. The residual vector\n\\begin{align*}\n\\boldsymbol{e} &= \\boldsymbol{y} - \\boldsymbol{X}\\boldsymbol{b} \\\\\n               &= \\boldsymbol{y} - \\boldsymbol{X}(\\boldsymbol{X}'\\boldsymbol{X})^{-1}\\boldsymbol{X}'\\boldsymbol{y} \\\\\n               &= (\\boldsymbol{I} -\\boldsymbol{X}(\\boldsymbol{X}'\\boldsymbol{X})^{-1}\\boldsymbol{X}')\\boldsymbol{y} \\\\\n               &= \\boldsymbol{R}\\boldsymbol{y} \\\\\n               &= \\boldsymbol{R}(\\boldsymbol{X}\\boldsymbol{\\beta} + \\boldsymbol{\\varepsilon}) \\\\\n               &= \\boldsymbol{R}\\boldsymbol{\\varepsilon}.\n\\end{align*}\nBecause \\text{rank}(\\boldsymbol{R}) = n - p - 1 &lt; n, \\boldsymbol{e} follows a degenerate multivariate normal distribution and does not have a density. Since the Kullback-Leibler divergence requires a proper density function, we need to simplify the covariance matrix of \\boldsymbol{e} by setting all the off-diagonal elements to 0. Then, the residuals will be assumed to follow N(\\boldsymbol{0}, diag(\\boldsymbol{R}\\sigma^2)) under the null hypothesis that the model is correctly specified. If the model is however misspecified due to omitted variables \\boldsymbol{Z}, or a non-constant variance \\boldsymbol{V}, the distribution of residuals can be derived as N(\\boldsymbol{R}\\boldsymbol{Z}\\boldsymbol{\\beta}_z, \\text{diag}(\\boldsymbol{R}\\sigma^2)) and N(\\boldsymbol{0}, \\text{diag}(\\boldsymbol{R}\\boldsymbol{V}\\boldsymbol{R}')) respectively.\nBy assuming both P and Q are multivariate normal density functions, the Kullback-Leibler divergence can be rewritten as KL = \\frac{1}{2}\\left(\\log\\frac{|\\Sigma_p|}{|\\Sigma_q|} - n + \\text{tr}(\\Sigma_p^{-1}\\Sigma_q) + (\\mu_p - \\mu_q)'\\Sigma_p^{-1}(\\mu_p - \\mu_q)\\right).\nThen, we can combine the two residual departures into one formula\n\nKL = \\frac{1}{2}\\left(\\log\\frac{|\\text{diag}(\\boldsymbol{R}\\boldsymbol{V}\\boldsymbol{R}')|}{|\\text{diag}(\\boldsymbol{R}\\sigma^2)|} - n + \\text{tr}(\\text{diag}(\\boldsymbol{R}\\boldsymbol{V}\\boldsymbol{R}')^{-1}\\text{diag}(\\boldsymbol{R}\\sigma^2)) + \\boldsymbol{\\mu}_z'(\\boldsymbol{R}\\boldsymbol{V}\\boldsymbol{R}')^{-1}\\boldsymbol{\\mu}_z\\right).\n\nWhen there are omitted variables but constant error variance, the formula can be reduced to\nKL = \\frac{1}{2}\\left(\\boldsymbol{\\mu}_z'(\\text{diag}(\\boldsymbol{R}\\sigma^2))^{-1}\\boldsymbol{\\mu}_z\\right).\nAnd when the model equation is correctly specified but the error variance is non-constant, the formula can be reduced to\nKL = \\frac{1}{2}\\left(log\\frac{|\\text{diag}(\\boldsymbol{R}\\boldsymbol{V}\\boldsymbol{R}')|}{|\\text{diag}(\\boldsymbol{R}\\sigma^2)|} - n + \\text{tr}(\\text{diag}(\\boldsymbol{R}\\boldsymbol{V}\\boldsymbol{R}')^{-1}\n\\text{diag}(\\boldsymbol{R}\\sigma^2))\\right).\nTo compute the effect size for each lineup we simulate a sufficiently large number of samples from the same model with the number of observations n fixed for each sample. We then compute the effect size for each sample and take the average as the final value. This ensures lineups constructed with the same experimental factors will share the same effect size.\n\nA.1.3 Sensitivity Analysis for \\alpha\n\nThe parameter \\alpha used for the p-value calculation needs to be estimated from responses to null lineups. With a greater value of \\hat{\\alpha}, the p-value will be smaller, resulting in more lineups being rejected. However, The way we generate Rorschach lineup is not strictly the same as what suggested in VanderPlas et al. (2021) and Buja et al. (2009). Therefore, we conduct a sensitivity analysis in this section to examine the impact of the variation of the estimator \\alpha on our primary findings.\nThe analysis is conducted by setting up several scenarios, where the \\alpha is under or overestimated by 12.5%, 25% and 50%. Using the adjusted \\hat{\\alpha}, we recalculate the p-value for every lineup and show the results in Figure . It can be observed that there are some changes to p-values, especially when the \\hat{\\alpha} is multiplied by 50%. However, Table shows that adjusting \\hat{\\alpha} will not result in a huge difference in rejection decisions. There are only a small percentage of cases where the rejection decision change. It is very unlikely the downstream findings will be affected because of the estimate of \\alpha.\n\n\n\n\nFigure A.1: Change of p-values with \\hat{\\alpha} multiplied by 0.5, 0.75, 0.875, 1.125, 1.25 and 1.5. Only lineups with uniform fitted value distribution is used. The vertical dashed line indicates p\\text{-value} = 0.05. The area coloured in red indicates \\text{adjusted }p\\text{-value} &lt; 0.05. The x-axis is drawn on logarithmic scale. For multipliers smaller than 1, the adjusted p\\text{-value} will initially increase and decline when the p\\text{-value} increases. The trend is opposite with multipliers greater than 1, but the difference eventually reaches 0.\n\n\n\n\n\n\n\n\n\nA.1.4 Effect of Number of Evaluations on the Power of a Visual Test\nWhen comparing power of visual tests across different fitted value distributions, we have discussed the number of evaluations on a lineup will affect the power of the visual test. Using the lineups with uniform fitted value distribution, we show in Figure A.2 the change of power of visual tests due to different number of evaluations. It can be learned that as the number of evaluations increases, the power will increase but the margin will decrease. Considering we have eleven evaluations on lineups with uniform fitted value distribution, and five evaluations on other lineups, it is necessary to use the same number of evaluations for each lineup in comparison.\n\n\n\n\nFigure A.2: Change of power of visual tests for different number of evalutions on lineups with uniform fitted value distribution. The power will increase as the number of evaluations increases, but the margin will decrease.\n\n\n\n\nA.1.5 Power of a RESET Test under Different Auxiliary Regression Formulas\nIt is found in the result that the power of a RESET test will be affected by the highest order of fitted values included in the auxiliary formula. And we suspect that the current recommendation of the highest order - four, is insufficient to test complex non-linear structures such as the “triple-U” shape designed in this paper. Figure A.3 illustrates the change of power of RESET test while testing the “U” shape and the “triple-U” shape with different highest orders. Clearly, when testing a simple shape like the “U” shape, the highest order has very little impact on the power. But for testing the “triple-U” shape, there will be a loss of power if the recommended order is used. To avoid the loss of power, the highest order needs to be set to at least six.\n\n\n\n\nFigure A.3: Change of power of RESET tests for different orders of fitted values included in the auxiliary formula. The left panel is the power of testing the “U” shape and the right panel is the power of testing the “triple-U” shape. The power will not be greatly affected by the highest order in the case of testing the “U” shape. In the case of testing the “triple-U” shape, the highest order needs to be set to at least six to avoid the loss of power.\n\n\n\n\nA.1.6 Conventional Test Rejection Rate for Varying Significance Levels\nIn the main paper, Section 2.5.1 and Section 2.5.2 compared the power, and the decisions made by the conventional tests and the visual test. The power curves for the visual test is effectively a right-shift from the conventional test. The effect is that the visual test rejects less often than the conventional test, at the same significance level. We also saw that the visual test rejected a subset of those that the conventional tests rejected. This means that they agreed quite well - only residual plots rejected by the conventional tests were rejected by the visual test. There was little disagreement, where residual plots not rejected by the conventional test were rejected by the visual test. The question arises whether the decisions made conventional test could be made similar to that of the visual test by reducing the significance level. Reducing the significance level from 0.05, to 0.01, 0.001, … will have the effect of rejecting fewer of the residual plots.\nIt would be interesting if a different conventional test significance level results in both the visual tests and conventional tests reject only the same residual plots, and fails to reject the same residual plots. This would be a state where both systems agree perfectly. Figure examines this. Plot A shows the percentage of residual plots rejected by the visual test, given the conventional test rejected (solid lines) or failed to reject (dashed lines). The vertical grey line marks significance level 0.05. When the significance level gets smaller, it is possible to see that the visual tests reject (nearly) 100% of the time that the conventional test rejects. However, there is no agreement, because the visual tests also increasingly reject residual plots where the conventional test failed to reject. Plot B is comparable to an ROC curve, where the percentage visual test rejection conditional on conventional test decision is plotted: Reject conditional on reject is plotted against reject conditional on fail to reject, for different significance levels. The non-linearity pattern results are close to being ideal, that the percentage of reject relative to fail to reject increases very slowly as the reject relative to reject converges to 100. The heteroskedasticity pattern is more problematic, and shows that the cost of rejecting less with the conventional test is disagreement with the visual test.\n\n\n\n\nFigure A.4: Changing the significance level of the conventional test will change the rejection rate. A: Percentage of conventional tests also rejected by the visual test: rejected (solid), not rejected (dashed). As the significance level is reduced, the percentage rejected by the visual test that has been rejected by the conventional test approaches 100. The percentage of tests not rejected by the conventional test also increases, as expected, but the percentage of these that are rejected by the visual test increases too. B: ROC curve shows that forcing the conventional test to not reject creates a discrepancy with the visual test. Many of the residual plots not rejected by the conventional test are rejected by the visual test. It is not possible to vary the significance level of the conventional test to match the decisions made by the visual test."
  },
  {
    "objectID": "A-appA.html#sec-appendix-a-2",
    "href": "A-appA.html#sec-appendix-a-2",
    "title": "Appendix A — Appendix to “A Plot is Worth a Thousand Tests: Assessing Residual Diagnostics with the Lineup Protocol”",
    "section": "\nA.2 Additional Details of Experimental Setup",
    "text": "A.2 Additional Details of Experimental Setup\n\nA.2.1 Non-linearity Model\nThe non-linearity model used in the experiment includes a non-linear term \\boldsymbol{z} constructed using Hermite polynomials on random vector \\boldsymbol{x} formulated as\n\\begin{align*}\n\\boldsymbol{y} &= \\boldsymbol{1}_n + \\boldsymbol{x} + \\boldsymbol{z} + \\boldsymbol{\\varepsilon},\\\\\n\\boldsymbol{x} &= g(\\boldsymbol{x}_{raw}, 1), \\\\\n\\boldsymbol{z} &= g(\\boldsymbol{z}_{raw}, 1), \\\\\n\\boldsymbol{z}_{raw} &= He_j(g(\\boldsymbol{x}, 2)),\n\\end{align*}\nwhere \\boldsymbol{y}, \\boldsymbol{x}, \\boldsymbol{\\varepsilon}, \\boldsymbol{x}_{raw}, \\boldsymbol{z}_{raw} are vectors of size n, \\boldsymbol{1}_n is a vector of ones of size n, He_{j}(.) is the jth-order probabilist’s Hermite polynomials (Hermite 1864; originally by Laplace 1820), \\varepsilon \\sim N(\\boldsymbol{0}_n, \\sigma^2\\boldsymbol{I}_n), and g(\\boldsymbol{x}, k) is a scaling function to enforce the support of the random vector to be [-k, k]^n defined as\n\ng(\\boldsymbol{x}, k) = 2k\\cdot\\frac{\\boldsymbol{x} - x_{min}\\boldsymbol{1}_n}{x_{max} - x_{min}} - k, \\quad \\text{for} \\quad k &gt; 0.\n\\tag{A.6}\nwhere \\displaystyle x_{min} = \\min_{i\\in \\{1, ..., n\\}} x_i, \\displaystyle x_{max} = \\max_{i\\in \\{1, ..., n\\}} x_i and x_i is the i-th entry of \\boldsymbol{x}. The function hermite from the R package mpoly (Kahle 2013) is used to simulate \\boldsymbol{z}_{raw} to generate Hermite polynomials.\nThe null regression model used to fit the realizations generated by the above model is formulated as\n\n\\boldsymbol{y} = \\beta_0\\boldsymbol{1}_n + \\beta_1 \\boldsymbol{x} + \\boldsymbol{u},\n\\tag{A.7}\nwhere \\boldsymbol{u} \\sim N(\\boldsymbol{0}, \\sigma^2\\boldsymbol{I}_n). Here \\boldsymbol{z} is a higher order term of \\boldsymbol{x} and leaving it out in the null regression results in model misspecification.\n\nA.2.2 Heteroskedasticity Model\nThe heteroskedasticity model used in the experiment is formulated as\n\\begin{align*}\n\\boldsymbol{y} &= \\boldsymbol{1}_n + \\boldsymbol{x} + \\boldsymbol{\\varepsilon},\\\\\n\\boldsymbol{x} &= g(\\boldsymbol{x}_{raw}, 1),\\\\\n\\boldsymbol{\\varepsilon} &\\sim N(\\boldsymbol{0}_n, \\boldsymbol{1}_n + (2 - |a|)(\\boldsymbol{x} - a\\boldsymbol{1}_n)'(\\boldsymbol{x} - a\\boldsymbol{1}_n) b \\boldsymbol{I}_n),\n\\end{align*}\nwhere \\boldsymbol{y}, \\boldsymbol{x}, \\boldsymbol{\\varepsilon} are vectors of size n and g(.) is the scaling function defined in Equation A.6. The null regression model used to fit the realizations generated by the above model is formulated exactly the same as Equation A.7.\nFor b \\neq 0, the variance-covariance matrix of the error term \\boldsymbol{\\varepsilon} is correlated with the predictor \\boldsymbol{x}, which will lead to the presence of heteroskedasticity.\nSince \\text{supp}(X) = [-1, 1], choosing a to be -1, 0 and 1 can generate “left-triangle”, “butterfly” and “right-triangle” shapes. The term (2 - |a|) maintains the magnitude of residuals across different values of a.\n\nA.2.3 Controlling the Signal Strength\nThe three parameters n, \\sigma and b are important for controlling the strength of the signal to generate lineups with a variety difficulty levels. This will ensure that estimated power curves will be smooth and continuous, and that participants are allocated a set of lineups with a range of difficulty.\nParameter \\sigma \\in \\{0.5, 1, 2, 4\\} and b \\in \\{0.25, 1, 4, 16, 64\\} are used in data collection periods I and II respectively. A large value of \\sigma will increase the variation of the error of the non-linearity model and decrease the visibility of the visual pattern. The parameter b controls the variation in the standard deviation of the error across the support of the predictor. A larger value of b generates a larger ratio between it is smallest and highest values, making the visual pattern more obvious. The sample size n sharpens (or blurs) a pattern when it is larger (or smaller).\n\nA.2.4 Lineup Allocation to Participants\nThere are a total of 4 \\times 4 \\times 3 \\times 4 = 192 and 3 \\times 5 \\times 3 \\times 4 = 180 combinations of parameter values for the non-linearity model and heteroskedasticity models respectively. Three replications for each combination results in 192 \\times 3 = 576 and 180 \\times 3 = 540 lineups, respectively.\nEach lineup needs to be evaluated by at least five participants. From previous work, and additional pilot studies for this experiment, we decided to record evaluations from 20 lineups for each participant. Two of the 20 lineups with clear visual patterns were used as attention checks, to ensure quality data. Thus, 576 \\times 5 / (20-2) = 160 and 540 \\times 5 / (20-2) = 150 participants were needed to cover the experimental design for the data collection periods I and II, respectively. The factor levels and range of difficulty was assigned relatively equally among participants.\nData collection period III was primarily to obtain Rorschach lineup evaluations to estimate \\alpha, and also to obtain additional evaluations of lineups made with uniform fitted value distribution to ensure consistency in the results. To construct a Rorschach lineup, the data is generated from a model with zero effect size, while the null data are generated using the residual rotation technique. This procedure differs from that of the canonical Rorschach lineup, where all 20 plots are generated directly from the null model, so the method suggested in VanderPlas et al. (2021) for typical lineups containing a data plot is used to estimate \\alpha. The 3 \\times 4 = 12 treatment levels of the common factors, replicated three times results in 36 lineups. And 6 more evaluations on the 279 lineups with uniform fitted value distribution, results in at least (36 \\times 20 + 279 \\times 3 \\times 6) / (20-2) = 133 participants needed.\n\nA.2.5 Mapping of Participants to Experimental Factors\nMapping of participants to experimental factors is an important part of experimental design. Essentially, we want to maximum the difference in factors exposed to a participant. For this purpose, we design an algorithm to conduct participant allocation. Let L be a set of available lineups and S be a set of available participants. According to the experimental design, the availability of a lineup is associated with the number of participants it can assign to. For lineups with uniform fitted value distribution, this value is 11. And other lineups can be allocated to at most five different participants. The availability of a participant is associated with the number of lineups that being allocated to this participant. A participant can view at most 18 different lineups.\nThe algorithm starts from picking a random participant s \\in S with the minimum number of allocated lineups. It then tries to find a lineup l \\in L that can maximise the distance metric D and allocate it to participant s. Set L and S will be updated and the picking process will be repeated until there is no available lineups or participants.\nLet F_1,...,F_q be q experimental factors, and f_1, ...,f_q be the corresponding factor values. We say f_i exists in L_{s} if any lineup in L_{s} has this factor value. Similarly, f_if_j exists in L_{s} if any lineup in L_{s} has this pair of factor values. And f_if_jf_k exists in L_{s} if any lineup in L_{s} has this trio of factor values. The distance metric D is defined between a lineup l and a set of lineups L_{s} allocated to a participant s if L_{s} is non-empty:\n\\begin{equation*}\nD =\nC - \\sum_{1\\leq i \\leq q}I(f_i\\text{ exists in }L_{s}) - \\sum_{\\substack{1\\leq i \\leq q-1 \\\\ i &lt; j \\leq q}}I(f_if_j\\text{ exists in }L_{s}) - \\sum_{\\substack{1\\leq i \\leq q - 2 \\\\ i &lt; j \\leq q - 1 \\\\ j &lt; k \\leq q}}I(f_if_jf_k\\text{ exists in }L_{s})\n\\end{equation*}\nwhere C is a sufficiently large constant such that D &gt; 0. If L_{s} is empty, we define D = 0.\nThe distance measures how different a lineup is from the set of lineups allocated to the participant in terms of factor values. Thus, the algorithm will try to allocate the most different lineup to a participant at each step.\nIn Figure A.5 and Figure A.6, we present examples of lineup allocations generated by our algorithm for data collection periods I and II, respectively. These figures illustrate the factor values presented to the first 20 participants recruited during each period. It can be observed that the algorithm effectively distributed almost all possible one-way and two-way factor combinations among the participants, thereby ensuring a diverse set of lineups for each participant.\n\n\n\n\nFigure A.5: Factor values assigned to the first 20 participants recruited during data collection period I, with data points slightly jittered to prevent overlap. Each participant have been exposed to all one-way and two-way factor combinations.\n\n\n\n\n\n\n\nFigure A.6: Factor values assigned to the first 20 participants recruited during data collection period II, with data points slightly jittered to prevent overlap. Each participant appears to have been exposed to almost all one-way and two-way factor combinations. However, two participants, namely participant 16 and participant 18, were not presented with lineups containing a butterfly shape with b = 4. Additionally, participant 7 did not encounter a lineup featuring a butterfly shape with b = 1.\n\n\n\n\nA.2.6 Data Collection Process\nThe survey data is collected via a self-hosted website designed by us. The complete architecture is provided in Figure A.7. The website is built with the Flask (Grinberg 2018) web framework and hosted on PythonAnywhere (PythonAnywhere LLP 2023). It is configured to handle HTTP requests such that participants can correctly receive webpages and submit responses. Embedded in the resources sent to participants, the jsPsych front-end framework (De Leeuw 2015) instructs participants’ browsers to render an environment for running behavioural experiments. During the experiment, this framework will automatically collect common behavioural data such as response time and clicks on buttons. participants’ responses are first validated by a scheduled Python script run on the server, then push to a Github repository. Lineup images shown to users are saved in multiple Github repositories and hosted in corresponding Github pages. The URLs to these images are resolved by Flask and bundled in HTML files.\nOnce the participant is recruited from Prolific (Palan and Schitter 2018), it will be redirected to the entry page of our study website. An image of the entry page is provided in Figure A.8. Then, the participant needs to submit the online consent form and fill in the demographic information as shown in Figure A.9 and Figure A.10 respectively. Before evaluating lineups, participant also need to read the training page as provide in Figure A.11 to understand the process. An example of the lineup page is given in Figure A.12. A half of the page is taken by the lineup image to attract participant’s attention. The button to skip the selections for the current lineup is intentionally put in the corner of the bounding box with smaller font size, such that participants will not misuse this functionality.\n\n\nFigure A.7: Diagram of online experimental setup. The server-side of the study website uses Flask as backend hosted on PythonAnywhere. And the client-side uses jsPsych to run experiment.\n\n\n\n\n\nFigure A.8: The entry page of the study website.\n\n\n\n\n\n\n\nFigure A.9: The consent form provided in the study website.\n\n\n\n\n\n\n\nFigure A.10: The form to provide demographic information.\n\n\n\n\n\n\n\nFigure A.11: The training page of the study website.\n\n\n\n\n\n\n\nFigure A.12: The lineup page of the study website."
  },
  {
    "objectID": "A-appA.html#analysis-of-results-relative-to-data-collection-process",
    "href": "A-appA.html#analysis-of-results-relative-to-data-collection-process",
    "title": "Appendix A — Appendix to “A Plot is Worth a Thousand Tests: Assessing Residual Diagnostics with the Lineup Protocol”",
    "section": "\nA.3 Analysis of Results Relative to Data Collection Process",
    "text": "A.3 Analysis of Results Relative to Data Collection Process\n\nA.3.1 Demographics\nThroughout the study, we have collected 7254 evaluations on 1116 non-null lineups. Table A.1 gives further details about the number of evaluations, lineups and participants over pattern types and data collection periods.\n\n\n\n\nTable A.1: Count of lineups, evaluations and participants over departure types and data collection periods.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nNon-linearity\n\n\nHeteroskedasticity\n\n\n\n\nNumber\nI\nII\nIII\nI\nII\nII\nTotal\n\n\n\n\nLineups\n576\n0\n144\n0\n540\n135\n1116\n\n\nEvaluations\n2880\n0\n864\n0\n2700\n810\n7254\n\n\nParticipants\n160\n0\n123\n0\n160\n123\n443\n\n\n\n\n\n\n\n\nAlong with the responses to lineups, we have collected a series of demographic information including age, pronoun, education background and previous experience in studies involved data visualization. Table A.2, Table A.3, Table A.4 and Table A.5 provide summary of the demographic data.\nIt can be observed from the tables that most participants have Diploma or Bachelor degrees, followed by High school or below and the survey data is gender balanced. Majority of participants are between 18 to 39 years old and there are slightly more participants who do not have previous experience than those who have.\n\n\n\n\nTable A.2: Summary of pronoun distribution of participants recruited in this study.\n\nPronoun\nPeriod I\n%\nPeriod II\n%\nPeriod III\n%\nTotal\n%\n\n\n\nHe\n77\n17.4\n79\n17.8\n61\n13.8\n217\n49.0\n\n\nShe\n78\n17.6\n77\n17.4\n61\n13.8\n216\n48.8\n\n\nOther\n5\n1.1\n4\n0.9\n1\n0.2\n10\n2.3\n\n\n\n160\n36.1\n160\n36.1\n123\n27.8\n443\n100.0\n\n\n\n\n\n\n\n\n\n\n\n\nTable A.3: Summary of age distribution of participants recruited in this study.\n\nAge group\nPeriod I\n%\nPeriod II\n%\nPeriod III\n%\nTotal\n%\n\n\n\n18-24\n83\n18.7\n86\n19.4\n51\n11.5\n220\n49.7\n\n\n25-39\n69\n15.6\n63\n14.2\n63\n14.2\n195\n44.0\n\n\n40-54\n6\n1.4\n8\n1.8\n6\n1.4\n20\n4.5\n\n\n55-64\n2\n0.5\n3\n0.7\n3\n0.7\n8\n1.8\n\n\n\n160\n36.1\n160\n36.1\n123\n27.8\n443\n100.0\n\n\n\n\n\n\n\n\n\n\n\n\nTable A.4: Summary of education distribution of participants recruited in this study.\n\nEducation\nPeriod I\n%\nPeriod II\n%\nPeriod III\n%\nTotal\n%\n\n\n\nHigh School or below\n41\n9.3\n53\n12.0\n33\n7.4\n127\n28.7\n\n\nDiploma and Bachelor Degree\n92\n20.8\n79\n17.8\n66\n14.9\n237\n53.5\n\n\nHonours Degree\n6\n1.4\n15\n3.4\n6\n1.4\n27\n6.1\n\n\nMasters Degree\n21\n4.7\n13\n2.9\n16\n3.6\n50\n11.3\n\n\nDoctoral Degree\n0\n0.0\n0\n0.0\n2\n0.5\n2\n0.5\n\n\n\n160\n36.1\n160\n36.1\n123\n27.8\n443\n100.0\n\n\n\n\n\n\n\n\n\n\n\n\nTable A.5: Summary of previous experience distribution of participants recruited in this study.\n\nPrevious experience\nPeriod I\n%\nPeriod II\n%\nPeriod III\n%\nTotal\n%\n\n\n\nNo\n96\n21.7\n88\n19.9\n67\n15.1\n251\n56.7\n\n\nYes\n64\n14.4\n72\n16.3\n56\n12.6\n192\n43.3\n\n\n\n160\n36.1\n160\n36.1\n123\n27.8\n443\n100.0\n\n\n\n\n\n\n\n\n\nA.3.2 Data Collection Periods\n\n\n\n\nFigure A.13: A lineup of “letter-value” boxplots of weighted propotion of detect for lineups over different data collection periods for non-linearity model. Can you find the most different boxplot? The data plot is positioned in panel 2^3 - 1.\n\n\n\n\n\n\n\nFigure A.14: A lineup of “letter-value” boxplots of weighted propotion of detect for lineups over different data collection periods for heteroskedasticity model. Can you find the most different boxplot? The data plot is positioned in panel 2^4 - 2.\n\n\n\nWe have the same type of model collected over different data collection periods, that may lead to unexpected batch effect. Figure A.13 and Figure A.14 provide two lineups to examine whether there is an actual difference across data collection periods for non-linearity model and heteroskedasticity model respectively. To emphasize the tail behaviour and display fewer outliers, we use the “letter-value” boxplot (Hofmann et al. 2017) which is an extension of the number of “letter value” statistics to check the weighed proportion of detect over different data collection period. The weighted proportion of detect is calculated by taking the average of c_i of a lineup over a data collection period. Within our research team, we can not identify the data plot from the null plots for these two lineups, result in p-values much greater than 5%. Thus, there is no clear evidence of batch effect.\n\n\n\n\nBuja, A., Cook, D., Hofmann, H., Lawrence, M., Lee, E.-K., Swayne, D. F., and Wickham, H. (2009), “Statistical inference for exploratory data analysis and model diagnostics,” Philosophical Transactions of the Royal Society A: Mathematical, Physical and Engineering Sciences, The Royal Society Publishing, 367, 4361–4383.\n\n\nDe Leeuw, J. R. (2015), “jsPsych: A JavaScript library for creating behavioral experiments in a web browser,” Behavior Research Methods, Springer, 47, 1–12.\n\n\nGrinberg, M. (2018), Flask web development: Developing web applications with python, \" O’Reilly Media, Inc.\".\n\n\nHermite, M. (1864), Sur un nouveau développement en série des fonctions, Imprimerie de Gauthier-Villars.\n\n\nHofmann, H., Wickham, H., and Kafadar, K. (2017), “Value plots: Boxplots for large data,” Journal of Computational and Graphical Statistics, Taylor & Francis, 26, 469–477.\n\n\nKahle, D. (2013), “Mpoly: Multivariate polynomials in R,” The R Journal, 5, 162–170.\n\n\nKullback, S., and Leibler, R. A. (1951), “On information and sufficiency,” The Annals of Mathematical Statistics, JSTOR, 22, 79–86.\n\n\nLaplace, P.-S. (1820), Théorie analytique des probabilités, Courcier.\n\n\nMajumder, M., Hofmann, H., and Cook, D. (2013), “Validation of visual statistical inference, applied to linear models,” Journal of the American Statistical Association, Taylor & Francis, 108, 942–956.\n\n\nPalan, S., and Schitter, C. (2018), “Prolific. Ac—a subject pool for online experiments,” Journal of Behavioral and Experimental Finance, Elsevier, 17, 22–27.\n\n\nPythonAnywhere LLP (2023), “PythonAnywhere.”\n\n\nVanderPlas, S., Röttger, C., Cook, D., and Hofmann, H. (2021), “Statistical significance calculations for scenarios in visual inference,” Stat, Wiley Online Library, 10, e337."
  }
]