<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 2 Introduction | Visual Inference for Diagnostic of Nonlinearity and Heteroskedasticy in Linear Regression</title>
<meta name="author" content="Patrick Li">
<meta name="description" content="2.1 Specification error in linear regression Linear regression model is one of the fundamental statistical models of analyzing the relationship between a pair of variables \(Y\) and...">
<meta name="generator" content="bookdown 0.24 with bs4_book()">
<meta property="og:title" content="Chapter 2 Introduction | Visual Inference for Diagnostic of Nonlinearity and Heteroskedasticy in Linear Regression">
<meta property="og:type" content="book">
<meta property="og:description" content="2.1 Specification error in linear regression Linear regression model is one of the fundamental statistical models of analyzing the relationship between a pair of variables \(Y\) and...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 2 Introduction | Visual Inference for Diagnostic of Nonlinearity and Heteroskedasticy in Linear Regression">
<meta name="twitter:description" content="2.1 Specification error in linear regression Linear regression model is one of the fundamental statistical models of analyzing the relationship between a pair of variables \(Y\) and...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.11/header-attrs.js"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.2.5.1/tabs.js"></script><script src="libs/bs3compat-0.2.5.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><link rel="stylesheet" href="bs4_style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Visual Inference for Diagnostic of Nonlinearity and Heteroskedasticy in Linear Regression</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"><span class="header-section-number">1</span> About</a></li>
<li><a class="active" href="introduction.html"><span class="header-section-number">2</span> Introduction</a></li>
<li class="book-part">Experiment Setup</li>
<li><a class="" href="design-of-the-experiment.html"><span class="header-section-number">3</span> Design of the experiment</a></li>
<li><a class="" href="study-1.html"><span class="header-section-number">4</span> Study 1</a></li>
<li><a class="" href="study-2.html"><span class="header-section-number">5</span> Study 2</a></li>
<li class="book-part">Analysis of the experiment data</li>
<li><a class="" href="data-quality.html"><span class="header-section-number">6</span> Data quality</a></li>
<li><a class="" href="sharing-your-book.html"><span class="header-section-number">7</span> Sharing your book</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/rstudio/bookdown-demo">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="introduction" class="section level1" number="2">
<h1>
<span class="header-section-number">2</span> Introduction<a class="anchor" aria-label="anchor" href="#introduction"><i class="fas fa-link"></i></a>
</h1>
<div id="specification-error-in-linear-regression" class="section level2" number="2.1">
<h2>
<span class="header-section-number">2.1</span> Specification error in linear regression<a class="anchor" aria-label="anchor" href="#specification-error-in-linear-regression"><i class="fas fa-link"></i></a>
</h2>
<p>Linear regression model is one of the fundamental statistical models of analyzing the relationship between a pair of variables <span class="math inline">\(Y\)</span> and <span class="math inline">\(\boldsymbol{X}\)</span>. Under the classical settings, given a linear regression in the form,</p>
<p><span class="math display">\[\boldsymbol{Y} = \boldsymbol{X}\boldsymbol{\beta} + \boldsymbol{\varepsilon}.\]</span></p>
<p>Five assumptions will be assumed to satisfy:</p>
<ol style="list-style-type: decimal">
<li><span class="math inline">\(\mathbb{E}[\boldsymbol{\varepsilon}|\boldsymbol{X}] = \boldsymbol{0}\)</span></li>
<li><span class="math inline">\(\mathbb{E}[\boldsymbol{\varepsilon}\boldsymbol{\varepsilon}'|\boldsymbol{X}] = \sigma^2\boldsymbol{I}\)</span></li>
<li><span class="math inline">\(\mathbb{E}[\boldsymbol{X}'\boldsymbol{\varepsilon}|\boldsymbol{X}] = \boldsymbol{0}\)</span></li>
<li><span class="math inline">\(\boldsymbol{\varepsilon}|\boldsymbol{X} \sim N(\boldsymbol{0},\sigma^2\boldsymbol{I})\)</span></li>
<li>
<span class="math inline">\(\boldsymbol{X}'\boldsymbol{X}\)</span> is positive definite.</li>
</ol>
<p>Specification error occurs when at least one of the assumptions is violated. Efforts usually needs to made to check the validation of the assumptions if we would like to believe the derived statistical properties of the linear regression followed by the presumed underlying data generating process, rather than treat the linear regression as a predictive model which tries its best to approximate the true relationship between <span class="math inline">\(Y\)</span> and <span class="math inline">\(\boldsymbol{X}\)</span> with a straight line.</p>
</div>
<div id="visual-inference" class="section level2" number="2.2">
<h2>
<span class="header-section-number">2.2</span> Visual inference<a class="anchor" aria-label="anchor" href="#visual-inference"><i class="fas fa-link"></i></a>
</h2>
<p>As an alternative to conventional statistical tests, like F-test and Chow test, graphical devices for model diagnostic have been developed for years due to their ease of detecting recognizable violations of the assumptions, while providing the examiner with an opportunity to explore the fitted model in different views.</p>
<p>Unlike the conventional statistical tests, which is a deterministic procedure if the data and the significance level are given, the interpretation of the graphical devices will naturally and unavoidably vary from one observer to another, that is, the probability of the decision made by two observers are the same is not equal to one. This leads to potential over or under interpretation of the visual discoveries.</p>
<p>Visual inference is a class of hypothesis tests which introduces statistical inference for exploratory data analysis. It adopts graphic representation of data as the test statistic and relies on human evaluations of the test statistic to decide whether or not the null hypothesis should be rejected. This type of inference provides a method to statistically test visual discoveries, which helps calibrate the discovery process. Tough it will still suffer from individual effects, remedies can usually made by involving multiple individuals in a testing procedure.</p>
</div>
<div id="residual-plot" class="section level2" number="2.3">
<h2>
<span class="header-section-number">2.3</span> Residual plot<a class="anchor" aria-label="anchor" href="#residual-plot"><i class="fas fa-link"></i></a>
</h2>
<p>Among all the regression graphics, residual plot, or more specifically, residual versus fitted value plot is commonly used in examining the homoscedasticity and linearity assumptions put on the stochastic error term and the model.</p>
<div id="theoretical-results" class="section level3" number="2.3.1">
<h3>
<span class="header-section-number">2.3.1</span> Theoretical results<a class="anchor" aria-label="anchor" href="#theoretical-results"><i class="fas fa-link"></i></a>
</h3>
<p>Given the fitted linear regression model is</p>
<p><span class="math display">\[\boldsymbol{Y} = \boldsymbol{X}\boldsymbol{b} + \boldsymbol{e},\]</span></p>
<p>where <span class="math inline">\(\boldsymbol{b} = (\boldsymbol{X}'\boldsymbol{X})^{-1}\boldsymbol{X}'\boldsymbol{Y}\)</span> and <span class="math inline">\(\boldsymbol{e} = \boldsymbol{Y} - \boldsymbol{Xb}\)</span>.</p>
<div class="rmdnote">
<div class="proposition">
<p><span id="prp:unlabeled-div-1" class="proposition"><strong>Proposition 2.1  (Distribution of OLS residuals) </strong></span>Under the null hypothesis that the linear regression model is correctly specified, the residuals <span class="math inline">\(\boldsymbol{e}\)</span> follow a null distribution</p>
<p><span class="math display">\[\boldsymbol{e} \sim N(\boldsymbol{0},\boldsymbol{R}\sigma^2),\]</span>
where <span class="math inline">\(\boldsymbol{R} = \boldsymbol{I} - \boldsymbol{X}(\boldsymbol{X}'\boldsymbol{X})^{-1}\boldsymbol{X}'\)</span>.</p>
</div>
<div class="proof">
<p><span id="unlabeled-div-2" class="proof"><em>Proof</em>. </span>By the definition of the residuals <span class="math inline">\(\boldsymbol{e}\)</span>,</p>
<p><span class="math display">\[\begin{align*}
\boldsymbol{e} &amp;= \boldsymbol{Y} - \boldsymbol{Xb}\\
&amp;= \boldsymbol{Y} - \boldsymbol{X}(\boldsymbol{X}'\boldsymbol{X})^{-1}\boldsymbol{X}'\boldsymbol{Y}\\
&amp;= (\boldsymbol{I} - \boldsymbol{X}(\boldsymbol{X}'\boldsymbol{X})^{-1}\boldsymbol{X}')\boldsymbol{Y}\\
&amp;= \boldsymbol{R}\boldsymbol{Y}\\
&amp;= \boldsymbol{R}(\boldsymbol{X}\boldsymbol{\beta} + \boldsymbol{\varepsilon})\\
&amp;= (\boldsymbol{I} - \boldsymbol{X}(\boldsymbol{X}'\boldsymbol{X})^{-1}\boldsymbol{X}')\boldsymbol{X}\boldsymbol{\beta} + \boldsymbol{R}\boldsymbol{\varepsilon}\\
&amp;= \boldsymbol{R}\boldsymbol{\varepsilon}.\\
\end{align*}\]</span></p>
<p>Since by assumption, <span class="math inline">\(\boldsymbol{\varepsilon} \sim N(\boldsymbol{0},\sigma^2\boldsymbol{I})\)</span>, and because</p>
<p><span class="math display">\[\begin{align*}
\boldsymbol{R}\boldsymbol{R}' &amp;= (\boldsymbol{I} - \boldsymbol{X}(\boldsymbol{X}'\boldsymbol{X})^{-1}\boldsymbol{X}')(\boldsymbol{I} - \boldsymbol{X}(\boldsymbol{X}'\boldsymbol{X})^{-1}\boldsymbol{X}')' \\
&amp;= \boldsymbol{I} -  \boldsymbol{X}(\boldsymbol{X}'\boldsymbol{X})^{-1}\boldsymbol{X}' \\
&amp;= \boldsymbol{R}.
\end{align*}\]</span></p>
<p>Then,
<span class="math display">\[\boldsymbol{e} \sim N(\boldsymbol{0},\boldsymbol{R}\sigma^2).\]</span>
<span class="math display">\[\tag*{$\blacksquare$}\]</span></p>
</div>
</div>
<p>Clearly, under the null hypothesis, the residuals are heteroskedastic, since the matrix <span class="math inline">\(\boldsymbol{R}\)</span> is not an identity matrix. However, with large sample, the residuals <span class="math inline">\(\boldsymbol{e} \approx \boldsymbol{\varepsilon}\)</span>.</p>
<div class="rmdnote">
<div class="proposition">
<p><span id="prp:unlabeled-div-3" class="proposition"><strong>Proposition 2.2  (Consistency of OLS estimator) </strong></span>Suppose <span class="math display">\[T^{-1}\boldsymbol{X}'\boldsymbol{X} \overset{p}{\longrightarrow}\boldsymbol{G}_{XX} \quad as ~n \longrightarrow \infty,\]</span> where <span class="math inline">\(\boldsymbol{G}_{XX}\)</span> is a positive definite matrix of finite elements. And <span class="math display">\[T^{-1}\boldsymbol{X}'\boldsymbol{\varepsilon} \overset{p}{\longrightarrow}\boldsymbol{0} \quad as ~n \longrightarrow \infty.\]</span> Then the OLS estimator for <span class="math inline">\(\boldsymbol{b}\)</span> is consistent, that is <span class="math display">\[\boldsymbol{b} \overset{p}{\longrightarrow}\boldsymbol{\beta} \quad as ~n \longrightarrow \infty.\]</span></p>
</div>
<div class="proof">
<p><span id="unlabeled-div-4" class="proof"><em>Proof</em>. </span>Given the OLS solution is
<span class="math display">\[\begin{align*}
\boldsymbol{b} &amp;= (\boldsymbol{X}'\boldsymbol{X})^{-1}\boldsymbol{X}'\boldsymbol{Y} \\
&amp;= (\boldsymbol{X}'\boldsymbol{X})^{-1}\boldsymbol{X}'(\boldsymbol{X}\boldsymbol{\beta} + \boldsymbol{\varepsilon}) \\
&amp;= \boldsymbol{\beta} + (\boldsymbol{X}'\boldsymbol{X})^{-1}\boldsymbol{X}'\boldsymbol{\varepsilon}.
\end{align*}\]</span></p>
<p>Thus, by Slutsky’s theorem the probability limit of <span class="math inline">\(\boldsymbol{b}\)</span> is</p>
<p><span class="math display">\[plim(\boldsymbol{b}) = plim(\boldsymbol{\beta}+ (\boldsymbol{X}'\boldsymbol{X})^{-1}\boldsymbol{X}'\boldsymbol{\varepsilon})=\boldsymbol{\beta}+\boldsymbol{G}_{XX}^{-1}\boldsymbol{0}=\boldsymbol{\beta}.\]</span></p>
<p><span class="math display">\[\tag*{$\blacksquare$}\]</span></p>
</div>
</div>
<p>This suggests, the difference between <span class="math inline">\(\boldsymbol{b}\)</span> and <span class="math inline">\(\boldsymbol{\beta}\)</span> is small in large sample size. Therefore, the difference between <span class="math inline">\(\boldsymbol{e}\)</span> and <span class="math inline">\(\boldsymbol{\varepsilon}\)</span> will also be small in large sample size, that is
<span class="math display">\[\boldsymbol{\varepsilon}\overset{approx}{\sim} N(\boldsymbol{0},\sigma^2\boldsymbol{I}).\]</span></p>
</div>
<div id="emprical-use" class="section level3" number="2.3.2">
<h3>
<span class="header-section-number">2.3.2</span> Emprical use<a class="anchor" aria-label="anchor" href="#emprical-use"><i class="fas fa-link"></i></a>
</h3>
<p>TODO: how to interpret residual plot?</p>

</div>
</div>
</div>



  <div class="chapter-nav">
<div class="prev"><a href="index.html"><span class="header-section-number">1</span> About</a></div>
<div class="next"><a href="design-of-the-experiment.html"><span class="header-section-number">3</span> Design of the experiment</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#introduction"><span class="header-section-number">2</span> Introduction</a></li>
<li><a class="nav-link" href="#specification-error-in-linear-regression"><span class="header-section-number">2.1</span> Specification error in linear regression</a></li>
<li><a class="nav-link" href="#visual-inference"><span class="header-section-number">2.2</span> Visual inference</a></li>
<li>
<a class="nav-link" href="#residual-plot"><span class="header-section-number">2.3</span> Residual plot</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#theoretical-results"><span class="header-section-number">2.3.1</span> Theoretical results</a></li>
<li><a class="nav-link" href="#emprical-use"><span class="header-section-number">2.3.2</span> Emprical use</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/rstudio/bookdown-demo/blob/master/01-intro.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/rstudio/bookdown-demo/edit/master/01-intro.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Visual Inference for Diagnostic of Nonlinearity and Heteroskedasticy in Linear Regression</strong>" was written by Patrick Li. It was last built on 2021-12-03.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
